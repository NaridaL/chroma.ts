{"version":3,"file":"index.umd.min.js","sources":["../src/index.ts"],"sourcesContent":["/**\n * @license\n *\n * chroma.js - JavaScript library for color conversions\n *\n * Copyright (c) 2011-2017, Gregor Aisch\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * 3. The name Gregor Aisch may not be used to endorse or promote products\n *    derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// tslint:disable:no-unnecessary-qualifier\n\nconst { abs, atan2, cos, floor, log, min, max, round, sign, sin, sqrt, cbrt, PI, hypot } = Math\n\nfunction lerp(a: number, b: number, f: number) {\n\treturn a + (b - a) * f\n}\nfunction lerpInv(a: number, b: number, f: number) {\n\treturn (f - a) / (b - a)\n}\nfunction clamp(x: number, min = 0, max = 1) {\n\treturn x < min ? min : x > max ? max : x\n}\n\nfunction newtonIterate1d(f: (x: number) => number, xStart: number, max_steps: number, eps: number = 1e-8): number {\n\tlet x = xStart,\n\t\tfx\n\twhile (max_steps-- && abs((fx = f(x))) > eps) {\n\t\tconst dfdx = (f(x + eps) - fx) / eps\n\t\tconsole.log(\"fx / dfdx\", fx / dfdx, \"fx\", fx, \"x\", x)\n\t\tx = x - fx / dfdx\n\t}\n\treturn x\n}\nfunction bisect(f: (x: number) => number, a: number, b: number, steps: number) {\n\t//assert(a < b)\n\tlet fA = f(a)\n\t// let fB = f(b)\n\t//assert(fA * fB < 0)\n\twhile (steps--) {\n\t\tconst c = (a + b) / 2\n\t\tconst fC = f(c)\n\t\t// console.log(\"fC\", fC, \"c\", c)\n\t\tif (sign(fA) == sign(fC)) {\n\t\t\ta = c\n\t\t\tfA = fC\n\t\t} else {\n\t\t\tb = c\n\t\t\t// fB = fC\n\t\t}\n\t}\n\t//assert(a <= (b + a) / 2)\n\t//assert(b >= (b + a) / 2)\n\treturn (a + b) / 2\n}\n\nconst TWOPI = 2 * PI\n\nconst DEG2RAD = PI / 180\n\nconst RAD2DEG = 180 / PI\n/**\n * @param alpha1 default=1\n * @example chroma(99, 99, 44, 0.7)\n */\nfunction chroma(red255: number, green255: number, blue255: number, alpha1?: number): chroma.Color\n/**\n * @example chroma('mediumorchid') // a css string\n * @example chroma([56, 203, 30]) // a RGB triple\n * @example chroma(0x4b0082) // a hex num\n * @example chroma([30, 0.8, 0.3], 'hsl') // explicit format\n */\nfunction chroma(x: chroma.Chromable, format?: ColorFormat): chroma.Color\n/**\n * This overload allows VS Code to suggest color names when you type `chroma('`.\n */\nfunction chroma(colorname: keyof typeof chroma.w3cx11, format?: \"name\"): chroma.Color\n/** @example chroma(30, 0.8, 0.3, 'hsl') */\nfunction chroma(channel0: number, channel1: chroma.Color, channel2: number, format: ColorFormat): chroma.Color\n/** @example chroma(0.3, 0.8, 0.3, 1, 'gl') */\nfunction chroma(\n\tchannel0: number,\n\tchannel1: chroma.Color,\n\tchannel2: number,\n\tchannel3: number,\n\tformat: ColorFormat,\n): chroma.Color\nfunction chroma(...args: any[]) {\n\tif (args[0] instanceof chroma.Color) {\n\t\treturn args[0]\n\t}\n\tif (args.length > 1 && \"string\" == typeof args[args.length - 1]) {\n\t\treturn guess(args.slice(0, args.length - 1), args[args.length - 1])\n\t} else if (Array.isArray(args[0])) {\n\t\treturn guess(args[0])\n\t} else {\n\t\treturn guess(args)\n\t}\n}\nexport default chroma\nexport { chroma }\nnamespace chroma {\n\t/**\n\t * A Chromable is any value which can be converted to a color. For ease of use, most functions accept these instead of\n\t * only Color values.\n\t */\n\texport type Chromable = number | string | Color | number[]\n\n\texport class Color {\n\t\t/** @internal */\n\t\tconstructor(\n\t\t\tprivate readonly r: number,\n\t\t\tprivate readonly g: number,\n\t\t\tprivate readonly b: number,\n\t\t\tprivate readonly a = 1,\n\t\t) {}\n\n\t\t// public shade() {\n\t\t// \tconst shades: [string, string, number][] = [\n\t\t// \t\t[\"ff0000\", \"red\"],\n\t\t// \t\t[\"ffa500\", \"orange\"],\n\t\t// \t\t[\"ffff00\", \"yellow\"],\n\t\t// \t\t[\"008000\", \"green\"],\n\t\t// \t\t[\"0000ff\", \"blue\"],\n\t\t// \t\t[\"ee82ee\", \"violet\"],\n\t\t// \t\t[\"a52a2a\", \"brown\"],\n\t\t// \t\t[\"000000\", \"black\"],\n\t\t// \t\t[\"808080\", \"grey\"],\n\t\t// \t\t[\"ffffff\", \"white\"],\n\t\t// \t] as any\n\t\t// \tfunction angleDiff(a: number, b: number) {\n\t\t// \t\tconst d = (a - b) % 360\n\t\t// \t\tif (d > 180) return d - 360\n\t\t// \t\tif (d < -180) return d + 360\n\t\t// \t\treturn d\n\t\t// \t}\n\t\t// \tshades.forEach(arr => arr.push(chroma(arr[0]).hsl()[0]))\n\t\t// \tconst [h, s, l] = this.hsl()\n\t\t// \tif (l > 0.9) return \"white\"\n\t\t// \tif (l > 0.8 && s < 0.2) return \"white\"\n\t\t// \tif (s < 0.1) return \"grey\"\n\t\t// \tif (s < 0.4 && h > 0 && h < 48) return \"brown\"\n\n\t\t// \tconst distanceInXYZ: { [hue: number]: number } = { 0: 0 }\n\t\t// \tfor (let i = 60; i <= 360; i += 60) {\n\t\t// \t\tdistanceInXYZ[i] =\n\t\t// \t\t\tdistanceInXYZ[i - 60] + chroma.distance(chroma.hsl(i - 60, 1, 0.5), chroma.hsl(i, 1, 0.5), \"xyz\")\n\t\t// \t}\n\t\t// \t// console.log(distanceInXYZ)\n\n\t\t// \tconst shadeEnds: { [hue: number]: number } = {\n\t\t// \t\t0: 9,\n\t\t// \t\t38: 48,\n\t\t// \t\t60: 65,\n\t\t// \t\t120: 165,\n\t\t// \t\t240: 245,\n\t\t// \t\t300: 338,\n\t\t// \t\t360: 369,\n\t\t// \t}\n\n\t\t// \tconst getColorDistanceAlongXYZHue = (hueDegrees: number) => {\n\t\t// \t\tconst base = hueDegrees - (hueDegrees % 60)\n\t\t// \t\treturn (\n\t\t// \t\t\tdistanceInXYZ[base] + chroma.distance(chroma.hsl(base, 1, 0.5), chroma.hsl(hueDegrees, 1, 0.5), \"xyz\")\n\t\t// \t\t)\n\t\t// \t}\n\t\t// \tconst colorXYZD = getColorDistanceAlongXYZHue(this.hsl()[0])\n\t\t// \tconst md = distanceInXYZ[360]\n\t\t// \tconst shadeHue =\n\t\t// \t\t(Object.keys(shadeEnds) as any[]).find(shadeHue => shadeEnds[shadeHue | 0] >= this.hsl()[0])! % 360\n\t\t// \treturn shades.find(([_hex, _name, _hue]) => (_hue | 0) === shadeHue)![1]\n\t\t// \t// process.exit()\n\t\t// \treturn withMax(shades, ([_hex, _name, _hue]) => {\n\t\t// \t\treturn -abs(angleDiff(this.hsl()[0], _hue))\n\t\t// \t})[1]\n\t\t// \treturn withMax(shades, ([_hex, _name, _hue]) => {\n\t\t// \t\tconst [thisL, thisA, thisB] = this.lab()\n\t\t// \t\tconst [L, A, B] = chroma(_hex).lab()\n\t\t// \t\treturn -hypot(thisL - L, thisA - A, thisB - B)\n\t\t// \t})[1]\n\t\t// }\n\n\t\t/**\n\t\t * @see [[chroma.mix]]\n\t\t */\n\t\tpublic mix(col2: Chromable, f: number, m: InterpolationMode = \"rgb\") {\n\t\t\treturn chroma.mix(this, col2, f, m)\n\t\t}\n\t\tpublic rgb(doRound = true, clamp_ = true): RGB {\n\t\t\tconst f = (t: number) => {\n\t\t\t\tif (doRound) t = round(t)\n\t\t\t\tif (clamp_) t = clamp(t, 0, 255)\n\t\t\t\treturn t\n\t\t\t}\n\t\t\tconst { r, g, b } = this\n\t\t\treturn [f(r), f(g), f(b)]\n\t\t}\n\t\tpublic rgba(doRound = true, clamp_ = true): RGBA {\n\t\t\tconst f = (t: number) => {\n\t\t\t\tif (doRound) t = round(t)\n\t\t\t\tif (clamp_) t = clamp(t, 0, 255)\n\t\t\t\treturn t\n\t\t\t}\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn [f(r), f(g), f(b), a]\n\t\t}\n\n\t\t/**\n\t\t * Return a hex-string representation of this color.\n\t\t *\n\t\t * @param mode\n\t\t * @see #num for a hex-number representation.\n\t\t * @example chroma('yellow').alpha(0.7).hex()\n\t\t * @example chroma('yellow').alpha(0.7).hex('rgba')\n\t\t * @example chroma('yellow').alpha(0.7).hex('argb')\n\t\t */\n\t\tpublic hex(mode: \"rgb\" | \"rgba\" | \"argb\" = \"rgb\") {\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn rgb2hex(r, g, b, a, mode)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [HSL] representation of this color. hue will always be in [0;360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').hsl()\n\t\t */\n\t\tpublic hsl(): HSL {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2hsl(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [HSL] representation of this color. hue will always be in [0;360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').hsv()\n\t\t */\n\t\tpublic hsv() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2hsv(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [HSL] representation of this color. hue will always be in [0;360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').hcg()\n\t\t */\n\t\tpublic hcg() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2hcg(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns a CSS `rgb(...)` or `hsl(...)` string representation that can be used as CSS-color definition. The alpha\n\t\t * value is not output if it 1.\n\t\t * @example chroma('teal').css() // == \"rgb(0,128,128)\"\n\t\t * @example chroma('teal').alpha(0.5).css() // == \"rgba(0,128,128,0.5)\"\n\t\t * @example chroma('teal').css('hsl') // == \"hsl(180,100%,25.1%)\"\n\t\t */\n\t\tpublic css(mode: \"rgb\" | \"hsl\" = \"rgb\") {\n\t\t\tif (\"rgb\" == mode) {\n\t\t\t\tconst { r, g, b, a } = this\n\t\t\t\treturn rgb2css(r, g, b, a)\n\t\t\t} else if (\"hsl\" == mode) {\n\t\t\t\treturn hsl2css(this.hsl(), this.alpha())\n\t\t\t} else {\n\t\t\t\tthrow new Error()\n\t\t\t}\n\t\t}\n\n\t\tpublic name(closest: true): string\n\t\t/**\n\t\t * Get the name of a color. By default, this method will try to match the color exactly (comparing rounded RGB\n\t\t * values). Pass `true` to return the name of the color which is closest to `this` in CIELAB color space. CIELAB is\n\t\t * used as it is perceptually uniform.\n\t\t * @param closest Whether this should find the closest color name. default=false\n\t\t * @return If `closest == false`, the name of this color or `undefined` if there is no match. Otherwise, will always\n\t\t * return a color name.\n\t\t * @example chroma('#ff0000').name() // == \"red\"\n\t\t * @example chroma('#ff0001').name() // == undefined\n\t\t * @example chroma('#ff0001').name(true) // == \"red\"\n\t\t */\n\t\tpublic name(closest?: boolean): string | undefined\n\t\tpublic name(closest: boolean = false): string | undefined {\n\t\t\tconst num = this.num()\n\t\t\tconst name = Object.keys(chroma.w3cx11).find(name => (chroma.w3cx11 as any)[name] == num)\n\t\t\tif (!name && closest) {\n\t\t\t\tconst [thisLStar, thisAStar, thisBStar] = this.lab()\n\t\t\t\treturn withMax(Object.keys(chroma.w3cx11) as (keyof typeof chroma.w3cx11)[], name => {\n\t\t\t\t\tconst [lStar, aStar, bStar] = chroma.num(chroma.w3cx11[name]).lab()\n\t\t\t\t\treturn -hypot(thisLStar - lStar, thisAStar - aStar, thisBStar - bStar)\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn name\n\t\t}\n\n\t\t/**\n\t\t * Get the [CMYK](#chroma.CMYK) representation of this color.\n\t\t *\n\t\t * @example chroma('red').cmyk()\n\t\t */\n\t\tpublic cmyk() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2cmyk(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [GL] representation of this color.\n\t\t * @example chroma('33cc00').gl()\n\t\t */\n\t\tpublic gl(): GL {\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn [r / 255, g / 255, b / 255, a]\n\t\t}\n\n\t\t/**\n\t\t * Get luminance of the color. This is equal to the Y channel of the XYZ color space.\n\t\t * @example chroma('black').luminance() // == 0\n\t\t * @example chroma('white').luminance() // == 1\n\t\t * @example chroma('red').luminance() // == ~0.21\n\t\t * @see https://en.wikipedia.org/wiki/Relative_luminance\n\t\t */\n\t\tpublic luminance(): number\n\t\t/**\n\t\t * Return a new [Color] with `lum1` by linearly interpolating `this` with white (when increasing the luminance) or\n\t\t * black (otherwise) in the [XYZ] color space.\n\t\t * @see https://en.wikipedia.org/wiki/Relative_luminance\n\t\t * @example // Approximately doubling the luminance of red\n\t\t * @example chroma('red').luminance(0.4) // == #ff8686 // \"Vivid Tangerine\"\n\t\t * @param lum1 The desired luminance.\n\t\t */\n\t\tpublic luminance(lum1: number): this\n\t\tpublic luminance(lum1?: number) {\n\t\t\tconst { r, g, b, a } = this\n\t\t\tconst [, Y] = rgb2xyz(r, g, b)\n\t\t\tif (undefined === lum1) {\n\t\t\t\treturn Y\n\t\t\t}\n\t\t\tconst inverseLerp = (a: number, b: number, val: number) => (val - a) / (b - a)\n\t\t\tif (lum1 > Y) {\n\t\t\t\t// lerp to white\n\t\t\t\treturn chroma.mix(this, chroma(\"white\"), inverseLerp(Y, 1, lum1), \"xyz\").alpha(a)\n\t\t\t} else {\n\t\t\t\t// lerp to black\n\t\t\t\treturn chroma.mix(chroma(\"black\"), this, inverseLerp(0, Y, lum1), \"xyz\").alpha(a)\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Get color temperature of this color in Kelvin. This only makes sense for colors close to those output by\n\t\t * chroma.kelvin\n\t\t *\n\t\t * @example [c = chroma('#ff3300'), c.temperature()]\n\t\t * @example [c = chroma('#ffe3cd'), c.temperature()]\n\t\t * @example [c = chroma('#b3ccff'), c.temperature()]\n\t\t */\n\t\tpublic temperature() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2kelvin(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns a new [Color] with a channel changed.\n\t\t * @example chroma('skyblue').set('hsl.h', 0) // change hue to 0 deg (=red)\n\t\t * @example chroma('hotpink').set('lch.c', 30) // set chromaticity to 30\n\t\t * @example chroma('orangered').set('lab.l', x => x / 2) // half Lab lightness\n\t\t * @example chroma('darkseagreen').set('lch.c', x => x * 2) // double Lch saturation\n\t\t */\n\t\tpublic set(modeAndChannel: string, value: number | ((channel: number) => number)) {\n\t\t\tconst [mode, channel] = modeAndChannel.split(\".\") as [ColorMode, string]\n\t\t\tconst src = this[mode]()\n\t\t\tconst i = mode.indexOf(channel)\n\t\t\tif (-1 == i) throw new Error(\"invalid channel\")\n\t\t\tsrc[i] = \"number\" == typeof value ? value : value(src[i])\n\t\t\treturn chroma(src, mode).alpha(this.a)\n\t\t}\n\n\t\t/**\n\t\t * Returns whether this color is outside the RGB color cube and will be clipped/clamped when calling .rgb()\n\t\t *\n\t\t * @example [c = chroma.lch( 20, 40, 50), c.clipped()]\n\t\t * @example [c = chroma.lch( 40, 40, 50), c.clipped()]\n\t\t * @example [c = chroma.lch( 60, 40, 50), c.clipped()]\n\t\t * @example [c = chroma.lch( 80, 40, 50), c.clipped()]\n\t\t * @example [c = chroma.lch(100, 40, 50), c.clipped()]\n\t\t */\n\t\tpublic clipped() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn !(0 <= r && r <= 255 && (0 <= g && g <= 255) && (0 <= b && b <= 255))\n\t\t}\n\n\t\t/**\n\t\t * Returns black or white, whichever has the highest contrast to `this`.\n\t\t * In the readme you should see the result of this.\n\t\t *\n\t\t * @example chroma('red')\n\t\t * @example chroma('yellow')\n\t\t */\n\t\tpublic textColor() {\n\t\t\treturn this.luminance() > 0.5 ? chroma.black : chroma.white\n\t\t}\n\n\t\t/**\n\t\t * Get alpha value of color.\n\t\t * @example chroma.rgb(0, 0, 255, 0.5).alpha() // == 0.5\n\t\t */\n\t\tpublic alpha(): number\n\t\t/**\n\t\t * Return new [Color] with given alpha value.\n\t\t * @example chroma('green').alpha(0.3)\n\t\t * @example chroma('green').alpha(0.3).hex('rgba') // == \"#00ff004d\"\n\t\t * @param alpha1 The desired alpha value.\n\t\t */\n\t\tpublic alpha(alpha1: number): Color\n\t\tpublic alpha(alpha1?: number): number | Color {\n\t\t\tif (undefined === alpha1) {\n\t\t\t\treturn this.a\n\t\t\t}\n\t\t\tconst { r, g, b } = this\n\t\t\treturn chroma.rgb(r, g, b, alpha1)\n\t\t}\n\n\t\tpublic darker(amount = 1) {\n\t\t\tconst [l, a, b] = this.lab()\n\t\t\treturn chroma.lab(l - LAB_Kn * amount, a, b, this.alpha())\n\t\t}\n\n\t\t/**\n\t\t *\n\t\t * @param amount\n\t\t * @example chroma('hotpink')\n\t\t * @example chroma('hotpink').brighter()\n\t\t * @example chroma('hotpink').brighter(2)\n\t\t * @example chroma('hotpink').brighter(3)\n\t\t */\n\t\tpublic brighter(amount = 1) {\n\t\t\treturn this.darker(-amount)\n\t\t}\n\n\t\t/**\n\t\t * Returns a new [Color] with increased saturation.\n\t\t * @param amount How much.\n\t\t * @example chroma('slategray')\n\t\t * @example chroma('slategray').saturate()\n\t\t * @example chroma('slategray').saturate(2)\n\t\t * @example chroma('slategray').saturate(3)\n\t\t */\n\t\tpublic saturate(amount = 1) {\n\t\t\tconst [l, c, h] = this.lch()\n\t\t\treturn chroma.lch(l, max(0, c + amount * LAB_Kn), h, this.alpha())\n\t\t}\n\n\t\t/**\n\t\t * Equivalent to `saturate(-amount)`.\n\t\t * @see #saturate\n\t\t */\n\t\tpublic desaturate(amount = 1) {\n\t\t\treturn this.saturate(-amount)\n\t\t}\n\n\t\tpublic premultiplied() {\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn chroma.rgb(r * a, g * a, b * a, a)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [HSI] representation of this color. hue will always be in [0; 360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').hsi()\n\t\t */\n\t\tpublic hsi() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2hsi(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [LAB] representation of this color.\n\t\t *\n\t\t * @example chroma('purple').lab()\n\t\t */\n\t\tpublic lab() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2lab(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Return a hex-num of this color.\n\t\t *\n\t\t * @param mode\n\t\t * @see #num for a hex-number representation.\n\t\t * @example chroma('yellow').alpha(0.7).hex()\n\t\t * @example chroma('yellow').alpha(0.7).hex('rgba')\n\t\t * @example chroma('yellow').alpha(0.7).hex('argb')\n\t\t */\n\t\tpublic num(mode: \"rgb\" | \"rgba\" | \"argb\" = \"rgb\") {\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn rgb2num(r, g, b, a, mode)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [LCH] representation of this color. hue will always be in [0; 360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').lch()\n\t\t */\n\t\tpublic lch() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2lch(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Returns the [XYZ] representation of this color. hue will always be in [0; 360). Values are never NaN.\n\t\t *\n\t\t * @example chroma('purple').xyz()\n\t\t */\n\t\tpublic xyz() {\n\t\t\tconst { r, g, b } = this\n\t\t\treturn rgb2xyz(r, g, b)\n\t\t}\n\n\t\t/**\n\t\t * Whether this [Color](#chroma.Color) is identical (strict equality of r, g, b, a) to `color`.\n\t\t */\n\t\tpublic equals(color: Color) {\n\t\t\tconst { r, g, b, a } = this\n\t\t\tconst { r: r2, g: g2, b: b2, a: a2 } = color\n\t\t\treturn r == r2 && g == g2 && b == b2 && a == a2\n\t\t}\n\n\t\tpublic hashCode() {\n\t\t\treturn this.num(\"rgba\")\n\t\t}\n\n\t\t/**\n\t\t * @example chroma('red').toSource() // == \"chroma.rgb(255, 0, 0)\"\n\t\t * @example chroma.rgb(-2, 100.02, 200, 0.5).toSource() // == \"chroma.rgb(-2, 100.02, 200, 0.5)\"\n\t\t */\n\t\tpublic toSource() {\n\t\t\tconst { r, g, b, a } = this\n\t\t\treturn \"chroma.rgb(\" + r + \", \" + g + \", \" + b + (a === 1 ? \")\" : \", \" + a + \")\")\n\t\t}\n\t}\n\texport interface Color {\n\t\ttoString(): string\n\t\t//darker(amount: number): Color\n\t\t//brighter(amount: number): Color\n\t\tkelvin(): number\n\t}\n\tColor.prototype.toString = Color.prototype.css\n\tColor.prototype.kelvin = Color.prototype.temperature\n\t/**\n\t * @example chroma.black\n\t */\n\texport const black = new Color(0, 0, 0, 1)\n\n\t/**\n\t * @example chroma.black\n\t */\n\texport const white = new Color(255, 255, 255, 1)\n\n\texport const brewer = {\n\t\tOrRd: [0xfff7ec, 0xfee8c8, 0xfdd49e, 0xfdbb84, 0xfc8d59, 0xef6548, 0xd7301f, 0xb30000, 0x7f0000],\n\t\tPuBu: [0xfff7fb, 0xece7f2, 0xd0d1e6, 0xa6bddb, 0x74a9cf, 0x3690c0, 0x0570b0, 0x045a8d, 0x023858],\n\t\tBuPu: [0xf7fcfd, 0xe0ecf4, 0xbfd3e6, 0x9ebcda, 0x8c96c6, 0x8c6bb1, 0x88419d, 0x810f7c, 0x4d004b],\n\t\tOranges: [0xfff5eb, 0xfee6ce, 0xfdd0a2, 0xfdae6b, 0xfd8d3c, 0xf16913, 0xd94801, 0xa63603, 0x7f2704],\n\t\tBuGn: [0xf7fcfd, 0xe5f5f9, 0xccece6, 0x99d8c9, 0x66c2a4, 0x41ae76, 0x238b45, 0x006d2c, 0x00441b],\n\t\tYlOrBr: [0xffffe5, 0xfff7bc, 0xfee391, 0xfec44f, 0xfe9929, 0xec7014, 0xcc4c02, 0x993404, 0x662506],\n\t\tYlGn: [0xffffe5, 0xf7fcb9, 0xd9f0a3, 0xaddd8e, 0x78c679, 0x41ab5d, 0x238443, 0x006837, 0x004529],\n\t\tReds: [0xfff5f0, 0xfee0d2, 0xfcbba1, 0xfc9272, 0xfb6a4a, 0xef3b2c, 0xcb181d, 0xa50f15, 0x67000d],\n\t\tRdPu: [0xfff7f3, 0xfde0dd, 0xfcc5c0, 0xfa9fb5, 0xf768a1, 0xdd3497, 0xae017e, 0x7a0177, 0x49006a],\n\t\tGreens: [0xf7fcf5, 0xe5f5e0, 0xc7e9c0, 0xa1d99b, 0x74c476, 0x41ab5d, 0x238b45, 0x006d2c, 0x00441b],\n\t\tYlGnBu: [0xffffd9, 0xedf8b1, 0xc7e9b4, 0x7fcdbb, 0x41b6c4, 0x1d91c0, 0x225ea8, 0x253494, 0x081d58],\n\t\tPurples: [0xfcfbfd, 0xefedf5, 0xdadaeb, 0xbcbddc, 0x9e9ac8, 0x807dba, 0x6a51a3, 0x54278f, 0x3f007d],\n\t\tGnBu: [0xf7fcf0, 0xe0f3db, 0xccebc5, 0xa8ddb5, 0x7bccc4, 0x4eb3d3, 0x2b8cbe, 0x0868ac, 0x084081],\n\t\tGreys: [0xffffff, 0xf0f0f0, 0xd9d9d9, 0xbdbdbd, 0x969696, 0x737373, 0x525252, 0x252525, 0x000000],\n\t\tYlOrRd: [0xffffcc, 0xffeda0, 0xfed976, 0xfeb24c, 0xfd8d3c, 0xfc4e2a, 0xe31a1c, 0xbd0026, 0x800026],\n\t\tPuRd: [0xf7f4f9, 0xe7e1ef, 0xd4b9da, 0xc994c7, 0xdf65b0, 0xe7298a, 0xce1256, 0x980043, 0x67001f],\n\t\tBlues: [0xf7fbff, 0xdeebf7, 0xc6dbef, 0x9ecae1, 0x6baed6, 0x4292c6, 0x2171b5, 0x08519c, 0x08306b],\n\t\tPuBuGn: [0xfff7fb, 0xece2f0, 0xd0d1e6, 0xa6bddb, 0x67a9cf, 0x3690c0, 0x02818a, 0x016c59, 0x014636],\n\t\tViridis: [0x440154, 0x482777, 0x3f4a8a, 0x31678e, 0x26838f, 0x1f9d8a, 0x6cce5a, 0xb6de2b, 0xfee825],\n\t\tSpectral: [\n\t\t\t0x9e0142,\n\t\t\t0xd53e4f,\n\t\t\t0xf46d43,\n\t\t\t0xfdae61,\n\t\t\t0xfee08b,\n\t\t\t0xffffbf,\n\t\t\t0xe6f598,\n\t\t\t0xabdda4,\n\t\t\t0x66c2a5,\n\t\t\t0x3288bd,\n\t\t\t0x5e4fa2,\n\t\t],\n\t\tRdYlGn: [\n\t\t\t0xa50026,\n\t\t\t0xd73027,\n\t\t\t0xf46d43,\n\t\t\t0xfdae61,\n\t\t\t0xfee08b,\n\t\t\t0xffffbf,\n\t\t\t0xd9ef8b,\n\t\t\t0xa6d96a,\n\t\t\t0x66bd63,\n\t\t\t0x1a9850,\n\t\t\t0x006837,\n\t\t],\n\t\tRdBu: [\n\t\t\t0x67001f,\n\t\t\t0xb2182b,\n\t\t\t0xd6604d,\n\t\t\t0xf4a582,\n\t\t\t0xfddbc7,\n\t\t\t0xf7f7f7,\n\t\t\t0xd1e5f0,\n\t\t\t0x92c5de,\n\t\t\t0x4393c3,\n\t\t\t0x2166ac,\n\t\t\t0x053061,\n\t\t],\n\t\tPiYG: [\n\t\t\t0x8e0152,\n\t\t\t0xc51b7d,\n\t\t\t0xde77ae,\n\t\t\t0xf1b6da,\n\t\t\t0xfde0ef,\n\t\t\t0xf7f7f7,\n\t\t\t0xe6f5d0,\n\t\t\t0xb8e186,\n\t\t\t0x7fbc41,\n\t\t\t0x4d9221,\n\t\t\t0x276419,\n\t\t],\n\t\tPRGn: [\n\t\t\t0x40004b,\n\t\t\t0x762a83,\n\t\t\t0x9970ab,\n\t\t\t0xc2a5cf,\n\t\t\t0xe7d4e8,\n\t\t\t0xf7f7f7,\n\t\t\t0xd9f0d3,\n\t\t\t0xa6dba0,\n\t\t\t0x5aae61,\n\t\t\t0x1b7837,\n\t\t\t0x00441b,\n\t\t],\n\t\tRdYlBu: [\n\t\t\t0xa50026,\n\t\t\t0xd73027,\n\t\t\t0xf46d43,\n\t\t\t0xfdae61,\n\t\t\t0xfee090,\n\t\t\t0xffffbf,\n\t\t\t0xe0f3f8,\n\t\t\t0xabd9e9,\n\t\t\t0x74add1,\n\t\t\t0x4575b4,\n\t\t\t0x313695,\n\t\t],\n\t\tBrBG: [\n\t\t\t0x543005,\n\t\t\t0x8c510a,\n\t\t\t0xbf812d,\n\t\t\t0xdfc27d,\n\t\t\t0xf6e8c3,\n\t\t\t0xf5f5f5,\n\t\t\t0xc7eae5,\n\t\t\t0x80cdc1,\n\t\t\t0x35978f,\n\t\t\t0x01665e,\n\t\t\t0x003c30,\n\t\t],\n\t\tRdGy: [\n\t\t\t0x67001f,\n\t\t\t0xb2182b,\n\t\t\t0xd6604d,\n\t\t\t0xf4a582,\n\t\t\t0xfddbc7,\n\t\t\t0xffffff,\n\t\t\t0xe0e0e0,\n\t\t\t0xbababa,\n\t\t\t0x878787,\n\t\t\t0x4d4d4d,\n\t\t\t0x1a1a1a,\n\t\t],\n\t\tPuOr: [\n\t\t\t0x7f3b08,\n\t\t\t0xb35806,\n\t\t\t0xe08214,\n\t\t\t0xfdb863,\n\t\t\t0xfee0b6,\n\t\t\t0xf7f7f7,\n\t\t\t0xd8daeb,\n\t\t\t0xb2abd2,\n\t\t\t0x8073ac,\n\t\t\t0x542788,\n\t\t\t0x2d004b,\n\t\t],\n\t\tSet2: [0x66c2a5, 0xfc8d62, 0x8da0cb, 0xe78ac3, 0xa6d854, 0xffd92f, 0xe5c494, 0xb3b3b3],\n\t\tAccent: [0x7fc97f, 0xbeaed4, 0xfdc086, 0xffff99, 0x386cb0, 0xf0027f, 0xbf5b17, 0x666666],\n\t\tSet1: [0xe41a1c, 0x377eb8, 0x4daf4a, 0x984ea3, 0xff7f00, 0xffff33, 0xa65628, 0xf781bf, 0x999999],\n\t\tSet3: [\n\t\t\t0x8dd3c7,\n\t\t\t0xffffb3,\n\t\t\t0xbebada,\n\t\t\t0xfb8072,\n\t\t\t0x80b1d3,\n\t\t\t0xfdb462,\n\t\t\t0xb3de69,\n\t\t\t0xfccde5,\n\t\t\t0xd9d9d9,\n\t\t\t0xbc80bd,\n\t\t\t0xccebc5,\n\t\t\t0xffed6f,\n\t\t],\n\t\tDark2: [0x1b9e77, 0xd95f02, 0x7570b3, 0xe7298a, 0x66a61e, 0xe6ab02, 0xa6761d, 0x666666],\n\t\tPaired: [\n\t\t\t0xa6cee3,\n\t\t\t0x1f78b4,\n\t\t\t0xb2df8a,\n\t\t\t0x33a02c,\n\t\t\t0xfb9a99,\n\t\t\t0xe31a1c,\n\t\t\t0xfdbf6f,\n\t\t\t0xff7f00,\n\t\t\t0xcab2d6,\n\t\t\t0x6a3d9a,\n\t\t\t0xffff99,\n\t\t\t0xb15928,\n\t\t],\n\t\tPastel2: [0xb3e2cd, 0xfdcdac, 0xcbd5e8, 0xf4cae4, 0xe6f5c9, 0xfff2ae, 0xf1e2cc, 0xcccccc],\n\t\tPastel1: [0xfbb4ae, 0xb3cde3, 0xccebc5, 0xdecbe4, 0xfed9a6, 0xffffcc, 0xe5d8bd, 0xfddaec, 0xf2f2f2],\n\t}\n\n\t/**\n\t * X11 color names\n\t * http://www.w3.org/TR/css3-color/#svg-color\n\t *\n\t * @example Object.keys(chroma.w3cx11).slice(0, 4)\n\t */\n\texport const w3cx11 = {\n\t\taliceblue: 0xf0f8ff,\n\t\tantiquewhite: 0xfaebd7,\n\t\taqua: 0x00ffff,\n\t\taquamarine: 0x7fffd4,\n\t\tazure: 0xf0ffff,\n\t\tbeige: 0xf5f5dc,\n\t\tbisque: 0xffe4c4,\n\t\tblack: 0x000000,\n\t\tblanchedalmond: 0xffebcd,\n\t\tblue: 0x0000ff,\n\t\tblueviolet: 0x8a2be2,\n\t\tbrown: 0xa52a2a,\n\t\tburlywood: 0xdeb887,\n\t\tcadetblue: 0x5f9ea0,\n\t\tchartreuse: 0x7fff00,\n\t\tchocolate: 0xd2691e,\n\t\tcoral: 0xff7f50,\n\t\tcornflower: 0x6495ed,\n\t\tcornflowerblue: 0x6495ed,\n\t\tcornsilk: 0xfff8dc,\n\t\tcrimson: 0xdc143c,\n\t\tcyan: 0x00ffff,\n\t\tdarkblue: 0x00008b,\n\t\tdarkcyan: 0x008b8b,\n\t\tdarkgoldenrod: 0xb8860b,\n\t\tdarkgray: 0xa9a9a9,\n\t\tdarkgreen: 0x006400,\n\t\tdarkgrey: 0xa9a9a9,\n\t\tdarkkhaki: 0xbdb76b,\n\t\tdarkmagenta: 0x8b008b,\n\t\tdarkolivegreen: 0x556b2f,\n\t\tdarkorange: 0xff8c00,\n\t\tdarkorchid: 0x9932cc,\n\t\tdarkred: 0x8b0000,\n\t\tdarksalmon: 0xe9967a,\n\t\tdarkseagreen: 0x8fbc8f,\n\t\tdarkslateblue: 0x483d8b,\n\t\tdarkslategray: 0x2f4f4f,\n\t\tdarkslategrey: 0x2f4f4f,\n\t\tdarkturquoise: 0x00ced1,\n\t\tdarkviolet: 0x9400d3,\n\t\tdeeppink: 0xff1493,\n\t\tdeepskyblue: 0x00bfff,\n\t\tdimgray: 0x696969,\n\t\tdimgrey: 0x696969,\n\t\tdodgerblue: 0x1e90ff,\n\t\tfirebrick: 0xb22222,\n\t\tfloralwhite: 0xfffaf0,\n\t\tforestgreen: 0x228b22,\n\t\tfuchsia: 0xff00ff,\n\t\tgainsboro: 0xdcdcdc,\n\t\tghostwhite: 0xf8f8ff,\n\t\tgold: 0xffd700,\n\t\tgoldenrod: 0xdaa520,\n\t\tgray: 0x808080,\n\t\tgreen: 0x008000,\n\t\tgreenyellow: 0xadff2f,\n\t\tgrey: 0x808080,\n\t\thoneydew: 0xf0fff0,\n\t\thotpink: 0xff69b4,\n\t\tindianred: 0xcd5c5c,\n\t\tindigo: 0x4b0082,\n\t\tivory: 0xfffff0,\n\t\tkhaki: 0xf0e68c,\n\t\tlaserlemon: 0xffff54,\n\t\tlavender: 0xe6e6fa,\n\t\tlavenderblush: 0xfff0f5,\n\t\tlawngreen: 0x7cfc00,\n\t\tlemonchiffon: 0xfffacd,\n\t\tlightblue: 0xadd8e6,\n\t\tlightcoral: 0xf08080,\n\t\tlightcyan: 0xe0ffff,\n\t\tlightgoldenrod: 0xfafad2,\n\t\tlightgoldenrodyellow: 0xfafad2,\n\t\tlightgray: 0xd3d3d3,\n\t\tlightgreen: 0x90ee90,\n\t\tlightgrey: 0xd3d3d3,\n\t\tlightpink: 0xffb6c1,\n\t\tlightsalmon: 0xffa07a,\n\t\tlightseagreen: 0x20b2aa,\n\t\tlightskyblue: 0x87cefa,\n\t\tlightslategray: 0x778899,\n\t\tlightslategrey: 0x778899,\n\t\tlightsteelblue: 0xb0c4de,\n\t\tlightyellow: 0xffffe0,\n\t\tlime: 0x00ff00,\n\t\tlimegreen: 0x32cd32,\n\t\tlinen: 0xfaf0e6,\n\t\tmagenta: 0xff00ff,\n\t\tmaroon: 0x800000,\n\t\tmaroon2: 0x7f0000,\n\t\tmaroon3: 0xb03060,\n\t\tmediumaquamarine: 0x66cdaa,\n\t\tmediumblue: 0x0000cd,\n\t\tmediumorchid: 0xba55d3,\n\t\tmediumpurple: 0x9370db,\n\t\tmediumseagreen: 0x3cb371,\n\t\tmediumslateblue: 0x7b68ee,\n\t\tmediumspringgreen: 0x00fa9a,\n\t\tmediumturquoise: 0x48d1cc,\n\t\tmediumvioletred: 0xc71585,\n\t\tmidnightblue: 0x191970,\n\t\tmintcream: 0xf5fffa,\n\t\tmistyrose: 0xffe4e1,\n\t\tmoccasin: 0xffe4b5,\n\t\tnavajowhite: 0xffdead,\n\t\tnavy: 0x000080,\n\t\toldlace: 0xfdf5e6,\n\t\tolive: 0x808000,\n\t\tolivedrab: 0x6b8e23,\n\t\torange: 0xffa500,\n\t\torangered: 0xff4500,\n\t\torchid: 0xda70d6,\n\t\tpalegoldenrod: 0xeee8aa,\n\t\tpalegreen: 0x98fb98,\n\t\tpaleturquoise: 0xafeeee,\n\t\tpalevioletred: 0xdb7093,\n\t\tpapayawhip: 0xffefd5,\n\t\tpeachpuff: 0xffdab9,\n\t\tperu: 0xcd853f,\n\t\tpink: 0xffc0cb,\n\t\tplum: 0xdda0dd,\n\t\tpowderblue: 0xb0e0e6,\n\t\tpurple: 0x800080,\n\t\tpurple2: 0x7f007f,\n\t\tpurple3: 0xa020f0,\n\t\trebeccapurple: 0x663399,\n\t\tred: 0xff0000,\n\t\trosybrown: 0xbc8f8f,\n\t\troyalblue: 0x4169e1,\n\t\tsaddlebrown: 0x8b4513,\n\t\tsalmon: 0xfa8072,\n\t\tsandybrown: 0xf4a460,\n\t\tseagreen: 0x2e8b57,\n\t\tseashell: 0xfff5ee,\n\t\tsienna: 0xa0522d,\n\t\tsilver: 0xc0c0c0,\n\t\tskyblue: 0x87ceeb,\n\t\tslateblue: 0x6a5acd,\n\t\tslategray: 0x708090,\n\t\tslategrey: 0x708090,\n\t\tsnow: 0xfffafa,\n\t\tspringgreen: 0x00ff7f,\n\t\tsteelblue: 0x4682b4,\n\t\ttan: 0xd2b48c,\n\t\tteal: 0x008080,\n\t\tthistle: 0xd8bfd8,\n\t\ttomato: 0xff6347,\n\t\tturquoise: 0x40e0d0,\n\t\tviolet: 0xee82ee,\n\t\twheat: 0xf5deb3,\n\t\twhite: 0xffffff,\n\t\twhitesmoke: 0xf5f5f5,\n\t\tyellow: 0xffff00,\n\t\tyellowgreen: 0x9acd32,\n\t}\n\n\t/**\n\t * Return a new [[CubeHelix]].\n\t *\n\t * @example chroma.cubehelix() // use the default helix\n\t * @example chroma.cubehelix().start(200).rotations(-0.5).gamma(0.8).lightness([0.3, 0.8])\n\t */\n\texport function cubehelix(\n\t\tstart = 300,\n\t\trotations = -1.5,\n\t\thue: number | [number, number] = 1,\n\t\tgamma = 1,\n\t\tlightness: number | [number, number] = [0, 1],\n\t) {\n\t\tconst f: CubeHelix = (t => f.at(t)) as CubeHelix\n\t\t;(Object.getOwnPropertyNames(CubeHelix.prototype) as (keyof typeof CubeHelix)[]).forEach(\n\t\t\tkey => (f[key] = CubeHelix.prototype[key]),\n\t\t)\n\t\tf.start(start)\n\t\tf.rotations(rotations)\n\t\tf.hue(hue)\n\t\tf.gamma(gamma)\n\t\tf.lightness(lightness)\n\t\treturn f\n\t}\n\n\t/**\n\t * [Dave Green's cubehelix color scheme](http://www.mrao.cam.ac.uk/~dag/CUBEHELIX/)!\n\t *\n\t * A CubeHelix is a function defined on [0, 1] which returns colors.\n\t */\n\texport interface CubeHelix {\n\t\t(f: number): Color\n\t}\n\texport class CubeHelix {\n\t\tprivate _start!: number\n\t\tprivate _rotations!: number\n\t\tprivate _gamma!: number\n\t\tprivate _hue!: [number, number]\n\t\tprivate _lightness!: [number, number]\n\t\tpublic start(s: number) {\n\t\t\tif (undefined === s) {\n\t\t\t\treturn this._start\n\t\t\t}\n\t\t\tthis._start = s\n\t\t\treturn this\n\t\t}\n\t\tpublic rotations(r: number) {\n\t\t\tif (undefined === r) {\n\t\t\t\treturn this._rotations\n\t\t\t}\n\t\t\tthis._rotations = r\n\t\t\treturn this\n\t\t}\n\t\tpublic gamma(g: number) {\n\t\t\tif (undefined === g) {\n\t\t\t\treturn this._gamma\n\t\t\t}\n\t\t\tthis._gamma = g\n\t\t\treturn this\n\t\t}\n\t\tpublic hue(h: number | [number, number]) {\n\t\t\tif (undefined === h) {\n\t\t\t\treturn this._hue\n\t\t\t}\n\t\t\tthis._hue = Array.isArray(h) ? h : [h, h]\n\t\t\treturn this\n\t\t}\n\t\tpublic lightness(h: number | [number, number]) {\n\t\t\tif (undefined === h) {\n\t\t\t\treturn this._lightness\n\t\t\t}\n\t\t\tthis._lightness = Array.isArray(h) ? h : [h, h]\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Convert to a [[Scale]].\n\t\t *\n\t\t * @example chroma.cubehelix().scale().correctLightness().domain(2, 22)\n\t\t */\n\t\tpublic scale() {\n\t\t\treturn scale(this)\n\t\t}\n\n\t\tpublic at(fract: number) {\n\t\t\tconst a = TWOPI * ((this._start + 120) / 360 + this._rotations * fract)\n\t\t\tconst l = lerp(this._lightness[0], this._lightness[1], fract) ** this._gamma\n\t\t\tconst h = lerp(this._hue[0], this._hue[1], fract)\n\t\t\tconst amp = (h * l * (1 - l)) / 2\n\t\t\tconst cos_a = cos(a)\n\t\t\tconst sin_a = sin(a)\n\t\t\tconst r = l + amp * (-0.14861 * cos_a + 1.78277 * sin_a)\n\t\t\tconst g = l + amp * (-0.29227 * cos_a - 0.90649 * sin_a)\n\t\t\tconst b = l + amp * (+1.97294 * cos_a)\n\t\t\treturn rgb([r * 255, g * 255, b * 255, 1])\n\t\t}\n\t}\n\n\t/**\n\t * Create a new random [Color] from a random point in the RGB color space.\n\t * @param randomSource A function which returns random `number`s in the interval [0; 1). Useful if you want to\n\t *     create a deterministic sequence of \"random\" colors. Defaults to `Math.random`.\n\t */\n\texport function random(randomSource = Math.random) {\n\t\treturn num((randomSource() * 0x1_00_00_00) | 0)\n\t}\n\n\t/**\n\t * Create a valid RGB color (`.clipped() == false`) from a random point in the CIELAB color space. This results in\n\t * more colors in the RGB color space where humans can perceive more differences.\n\t * @param randomSource A function which returns random `number`s in the interval [0; 1). Useful if you want to\n\t *     create a deterministic sequence of \"random\" colors. Defaults to `Math.random`.\n\t * @example chroma.random((() => { let i = 0; return () => (i = (i *Math.SQRT2) % 1); })())\n\t */\n\t// export function randomLab(randomSource = Math.random) {\n\t// \tconst labAMin = -87,\n\t// \t\tlabAMax = 99,\n\t// \t\tlabBMin = -108,\n\t// \t\tlabBMax = 95\n\t// \tlet maxIterations = 100\n\t// \twhile (maxIterations--) {\n\t// \t\tconst u = randomSource(),\n\t// \t\t\tv = randomSource(),\n\t// \t\t\tw = randomSource()\n\t// \t\t// The following matrix multiplication transform the random point (u v w) in the unit cube into the\n\t// \t\t// oriented bounding box (OBB) of the projection of the RGB space into the LAB space. This is necessary to\n\t// \t\t// avoid a huge number of misses.\n\t// \t\tconst color = chroma.lab(\n\t// \t\t\tu * -53.903 + v * -88.755 + w * 71.7 + 99.707,\n\t// \t\t\tu * -82.784 + v * 187.036 + w * -2.422 + -28.17,\n\t// \t\t\tu * -75.813 + v * -141.406 + w * -48.261 + 152.469,\n\t// \t\t)\n\t// \t\tconsole.log(color.lab())\n\t// \t\tconsole.log(color.rgba(false, false))\n\t// \t\tif (!color.clipped()) return color\n\t// \t}\n\t// \tthrow new Error(\"Could find a random color in 100 iterations\")\n\t// }\n\n\t/**\n\t * Mixes two colors. The mix ratio is a value between 0 and 1.\n\t * The color mixing produces different results based the color space used for interpolation.\n\t *\n\t * @param col2\n\t * @param f\n\t * @param m\n\t * @example chroma.mix('red', 'blue')\n\t * @example chroma.mix('red', 'blue', 0.25)\n\t * @example chroma.mix('red', 'blue', 0.75)\n\t *\n\t * @example chroma.mix('red', 'blue', 0.5, 'rgb')\n\t * @example chroma.mix('red', 'blue', 0.5, 'hsl')\n\t * @example chroma.mix('red', 'blue', 0.5, 'lab')\n\t * @example chroma.mix('red', 'blue', 0.5, 'lch')\n\t * @example chroma.mix('red', 'blue', 0.5, 'lrgb')\n\t */\n\texport function mix(col1: Chromable, col2: Chromable, f = 0.5, m: InterpolationMode = \"rgb\") {\n\t\tconst c1 = chroma(col1)\n\t\tconst c2 = chroma(col2)\n\t\tconst res = interpolators[m] && ((interpolators as any)[m](c1, c2, f, m) as Color)\n\t\tif (!res) {\n\t\t\tthrow new Error(\"color mode \" + m + \" is not supported\")\n\t\t}\n\t\treturn res.alpha(lerp(c1.alpha(), c2.alpha(), f))\n\t}\n\n\t/**\n\t * Parse a CSS color. See [MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/color) for all the possible\n\t * variants.\n\t *\n\t * @example chroma.css('hsl(2rad 90% 50% / 0.9)')\n\t * @example chroma.css('laserlemon')\n\t */\n\texport function css(cssString: string) {\n\t\tconst [r, g, b, a] = css2rgb(cssString)\n\t\treturn new Color(r, g, b, a)\n\t}\n\n\t/**\n\t * @example chroma.cmyk(0.2, 0.8, 0, 0)\n\t * @example chroma(0.2, 0.8, 0, 0, 'cmyk')\n\t */\n\texport function cmyk(cmyk: CMYK): Color\n\texport function cmyk(cyan1: number, magenta1: number, yellow1: number, key1: number): Color\n\texport function cmyk(...args: any[]) {\n\t\treturn guess(args, \"cmyk\")\n\t}\n\n\t/**\n\t * @example chroma.gl(1, 1, 0, 1)\n\t */\n\texport function gl(gl: RGBA | RGB): Color\n\t/**\n\t * @example chroma.gl([1, 0, 1, 0.5])\n\t */\n\texport function gl(red1: number, green1: number, blue1: number, alpha1: number): Color\n\texport function gl(...args: any[]) {\n\t\treturn guess(args, \"gl\")\n\t}\n\n\texport function hcg(hcg: HCG): Color\n\t/**\n\t * @param alpha1 default=1\n\t */\n\texport function hcg(h: number, c: number, g: number, alpha1?: number): Color\n\texport function hcg(...args: any[]) {\n\t\treturn guess(args, \"hcg\")\n\t}\n\n\texport function lch(lch: LCH): Color\n\t/**\n\t * @param alpha1 default=1\n\t */\n\texport function lch(h: number, c: number, l: number, alpha1?: number): Color\n\texport function lch(...args: any[]) {\n\t\treturn guess(args, \"lch\")\n\t}\n\n\texport function hsi(hsi: HSI): Color\n\t/**\n\t * @param alpha1 default=1\n\t */\n\texport function hsi(h: number, s: number, i: number, alpha1?: number): Color\n\texport function hsi(...args: any[]) {\n\t\treturn guess(args, \"hsi\")\n\t}\n\n\texport function hsl(hsl: HSL): Color\n\t/**\n\t * @param alpha1 default=1\n\t * @example chroma.hsl(30, 1, 0.5)\n\t * @example chroma.hsl(30, 0.6, 0.5)\n\t */\n\texport function hsl(hueDegrees: number, saturation1: number, lightness1: number, alpha1?: number): Color\n\texport function hsl(...args: any[]) {\n\t\treturn guess(args, \"hsl\")\n\t}\n\n\texport function hsv(hsv: LAB): Color\n\texport function hsv(h: number, s: number, v: number): Color\n\texport function hsv(...args: any[]) {\n\t\treturn guess(args, \"hsv\")\n\t}\n\n\t/**\n\t *\n\t * @param temperature\n\t * @example chroma.kelvin(2000) // candle light\n\t * @example chroma.kelvin(3500) // sunset\n\t * @example chroma.kelvin(6500) // daylight\n\t * @example x0_1 => chroma.kelvin(x0_1 * 30000) // effective range: [0; 30000]\n\t */\n\texport function kelvin(temperature: number) {\n\t\tconst [r, g, b] = kelvin2rgb(temperature)\n\t\treturn new Color(r, g, b)\n\t}\n\n\texport function lab(lab: LAB): Color\n\t/**\n\t * @param alpha1 default=1\n\t */\n\texport function lab(lightness1: number, a1: number, b: number, alpha1?: number): Color\n\texport function lab(...args: any[]) {\n\t\treturn guess(args, \"lab\")\n\t}\n\n\t/**\n\t * @example chroma.num(0x663399) // rebeccapurple\n\t */\n\texport function num(num: number) {\n\t\tconst [r, g, b] = num2rgb(num)\n\t\treturn new Color(r, g, b)\n\t}\n\n\texport function rgb(rgb: RGBA | RGB): Color\n\t/**\n\t * @param alpha1 default=1\n\t * @example chroma.rgb(0, 100, 200)\n\t */\n\texport function rgb(red255: number, green255: number, blue255: number, alpha1?: number): Color\n\texport function rgb(...args: any[]) {\n\t\treturn guess(args, \"rgb\")\n\t}\n\n\texport function xyz(xyz: XYZ): Color\n\t/** @param alpha1 default=1 */\n\texport function xyz(x1: number, y1: number, z1: number, alpha1?: number): Color\n\texport function xyz(...args: any[]) {\n\t\treturn guess(args, \"xyz\")\n\t}\n\n\t/**\n\t * Similar to chroma.mix, but accepts more than two colors.\n\t *\n\t * @example colors = ['#ddd', 'yellow', 'red', 'teal']\n\t * @example chroma.average(colors) // default = 'rgb'\n\t * @example chroma.average(colors, 'lab')\n\t * @example chroma.average(colors, 'lch')\n\t * @example chroma.average(colors, 'lrgb')\n\t * @example chroma.average(['red', 'rgba(0,0,0,0.5)']).css()\n\t */\n\texport function average(chromables: Chromable[], mode: InterpolationMode = \"rgb\") {\n\t\tconst colors = chromables.map(c => chroma(c))\n\t\tif (mode == \"lrgb\") {\n\t\t\treturn _average_lrgb(colors)\n\t\t}\n\t\tif (mode == \"num\") {\n\t\t\tlet numSum = 0,\n\t\t\t\talphaSum = 0\n\t\t\tfor (const col of colors) {\n\t\t\t\tnumSum += col.num()\n\t\t\t\talphaSum += col.alpha()\n\t\t\t}\n\t\t\treturn num(numSum / colors.length).alpha(alphaSum / colors.length)\n\t\t}\n\t\tconst xyz = [0, 0, 0]\n\t\tlet dx = 0\n\t\tlet dy = 0\n\t\tlet alphaSum = 0\n\t\tfor (const c of colors) {\n\t\t\tconst xyz2 = c[mode]()\n\t\t\talphaSum += c.alpha()\n\t\t\tconsole.log(alphaSum)\n\n\t\t\tfor (let i = 0; i < xyz.length; i++) {\n\t\t\t\tif (mode.charAt(i) == \"h\") {\n\t\t\t\t\tconst A = xyz2[i] * DEG2RAD\n\t\t\t\t\tdx += cos(A)\n\t\t\t\t\tdy += sin(A)\n\t\t\t\t} else {\n\t\t\t\t\txyz[i] += xyz2[i]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < xyz.length; i++) {\n\t\t\tif (mode.charAt(i) == \"h\") {\n\t\t\t\tconst A = atan2(dy / colors.length, dx / colors.length) * RAD2DEG\n\t\t\t\txyz[i] = (A + 360) % 360\n\t\t\t} else {\n\t\t\t\txyz[i] = xyz[i] / colors.length\n\t\t\t}\n\t\t}\n\t\treturn guess(xyz, mode).alpha(alphaSum / colors.length)\n\t}\n\n\t/**\n\t *\n\t * @param chromables\n\t * @example chroma.scale('black', 'red', 'gold') // linear interpolation\n\t * @example chroma.bezier('black', 'red', 'gold') // bezier interpolation\n\t */\n\texport function bezier(chromables: Chromable[]): { (t: number): Color; scale(): Scale }\n\texport function bezier(...chromables: Chromable[]): { (t: number): Color; scale(): Scale }\n\texport function bezier(...args: any[]) {\n\t\tconst chromables: Chromable[] = Array.isArray(args[0]) ? args[0] : args\n\t\tconst f = _bezier(chromables) as { (t: number): Color; scale(): Scale }\n\t\tf.scale = CubeHelix.prototype.scale\n\t\treturn f\n\t}\n\n\t/**\n\t * Blends two colors using RGB channel-wise blend functions.\n\t * @param bottom\n\t * @param top\n\t * @param mode\n\t * @example chroma.blend('4CBBFC', 'EEEE22', 'multiply')\n\t * @example chroma.blend('4CBBFC', 'EEEE22', 'darken')\n\t * @example chroma.blend('4CBBFC', 'EEEE22', 'lighten')\n\t */\n\texport function blend(bottom: Chromable, top: Chromable, mode: BlendMode) {\n\t\tif (!blend_fs[mode]) {\n\t\t\tthrow new Error(\"unknown blend mode \" + mode)\n\t\t}\n\t\treturn blend_fs[mode](bottom, top)\n\t}\n\texport type BlendMode = keyof typeof blend_fs\n\tnamespace blend_fs {\n\t\texport const normal = blend_f(each((a, _) => a))\n\t\texport const multiply = blend_f(each((a, b) => (a * b) / 255))\n\t\texport const screen = blend_f(each(_screen))\n\t\texport const overlay = blend_f(each(_overlay))\n\t\texport const darken = blend_f(each(min))\n\t\texport const lighten = blend_f(each(max))\n\t\texport const dodge = blend_f(each(_dodge))\n\t\texport const burn = blend_f(each(_burn))\n\t}\n\n\t/**\n\t * @param colors\n\t * @example scale = chroma.scale(['yellow', '008ae5'])\n\t * @example scale(0.25)\n\t * @example scale(0.5)\n\t * @example scale(0.75)\n\t * @example chroma.scale('Viridis')\n\t */\n\texport function scale(colors: Chromable[] | keyof typeof brewer | ((f: number) => Color)): Scale\n\texport function scale(...colors: Chromable[]): Scale\n\texport function scale(...args: any[]) {\n\t\tconst f: Scale = (t => (f as any)._at(t)) as Scale\n\t\t;(Object.getOwnPropertyNames(Scale.prototype) as (keyof typeof Scale)[]).forEach(\n\t\t\tkey => (f[key] = Scale.prototype[key]),\n\t\t)\n\t\tif (Array.isArray(args[0])) args = args[0]\n\t\tif (args.length == 1 && \"string\" == typeof args[0]) args = brewer[args[0] as keyof typeof brewer]\n\t\t;(f as any)._init(\"function\" == typeof args[0] ? args[0] : args.map(a => chroma(a)))\n\t\t//f.setColors(args.length > 1 ? args : args[0])\n\t\treturn f\n\t}\n\t/**\n\t * A color scale, created with chroma.scale, is a function that maps numeric values to a color palette.\n\t *\n\t * The type parameter describes the output type and can be changed with out(). Defaults to Color objects.\n\t *\n\t * @param T The output format. default=Color\n\t * @example chroma.scale('Purples')\n\t * @example chroma.scale('Purples')(0.4)\n\t */\n\texport interface Scale<T = Color> {\n\t\t(val: number): T\n\t}\n\texport class Scale<T = Color> {\n\t\tprivate _colors!: Color[] | ((t: number) => Color)\n\t\tprivate _classes!: number[] | undefined\n\t\t/**\n\t\t * Color cache. undefined if the cache should not be used.\n\t\t */\n\t\tprivate _cache!: Map<number, Color> | undefined\n\t\tprivate _correctLightness!: boolean\n\t\tprivate _gamma!: number\n\t\tprivate _mode!: InterpolationMode\n\t\tprivate _out!: ColorFormat | undefined\n\t\tprivate _min!: number\n\t\tprivate _max!: number\n\t\tprivate _paddingLeft!: number\n\t\tprivate _paddingRight!: number\n\t\t// positions of the colors on the interval [0, 1]. guaranteed to have the same length as _colors\n\t\t// undefined when _colors is a function\n\t\tprivate _pos: number[] | undefined\n\n\t\t/**\n\t\t * Get the current scale classes.\n\t\t */\n\t\tpublic classes(): number[]\n\t\t/**\n\t\t * Make the scale return a number of distint color instead of a continuous gradient.\n\t\t * If you pass a number the scale will broken into equi-distant classes:\n\t\t *\n\t\t * @example chroma.scale('OrRd') // continous\n\t\t * @example chroma.scale('OrRd').classes(5) // equidistant classes\n\t\t * @example chroma.scale('OrRd').classes(8)\n\t\t *\n\t\t * @example chroma.scale('OrRd').classes([0, 6, 11, 17, 20]) // also sets domain\n\t\t */\n\t\tpublic classes(classes: number | number[]): this\n\t\tpublic classes(classes?: number | number[]) {\n\t\t\tif (undefined === classes) {\n\t\t\t\treturn this._classes\n\t\t\t}\n\t\t\tif (Array.isArray(classes)) {\n\t\t\t\tthis._classes = classes\n\t\t\t\tthis.domain(classes[0], classes[classes.length - 1])\n\t\t\t} else {\n\t\t\t\tif (classes % 1 != 0 || classes < 1) throw new Error(\"invalid classes param\")\n\t\t\t\t// const d = analyze(this.domain())\n\t\t\t\tthis._classes = limits(this.domain(), \"e\", classes)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Get the domain.\n\t\t * @return If _colors is a function, [this._min, this._max]. If _colors is an array of colors, an array with the\n\t\t * same length as the number of colors.\n\t\t * @example chroma.scale(\"red\", \"white\", \"blue\").domain(0, 20).domain() // == [0, 10, 20]\n\t\t */\n\t\tpublic domain(): number[]\n\t\t/**\n\t\t * Set the domain interval on which the scale is defined. Colors are distributed equidistantly along the\n\t\t * interval.\n\t\t * @param start\n\t\t * @param end\n\t\t * @return `this`\n\t\t * @example chroma.scale(\"red\", \"white\", \"blue\").domain(0, 100)(50) // == white\n\t\t * @example chroma.scale(\"red\", \"white\", \"blue\").domain(0, 0.25, 1).domain(0, 100).domain() // == [0, 25, 100]\n\t\t */\n\t\tpublic domain(start: number, end: number): this\n\t\t/**\n\t\t * Set the domain interval and the individual positions of the colors. The number of passed values must match\n\t\t * the number of colors which define the scale. Not valid if the scale is defined by a function.\n\t\t * @param domain The positions of all scale colors. Values must be in ascending order and should not have\n\t\t * duplicates.\n\t\t * @return `this`\n\t\t * @example scale = chroma.scale(\"red\", \"white\", \"blue\").domain(0, 25, 100)\n\t\t * @example scale(25) // == white\n\t\t * @example scale(100) // == blue\n\t\t * @example scale(50) // == #aaaaff\n\t\t */\n\t\tpublic domain(...domain: number[]): this\n\t\tpublic domain(...domain: number[]): number[] | this {\n\t\t\tif (undefined === domain[0]) {\n\t\t\t\treturn \"function\" !== typeof this._colors\n\t\t\t\t\t? this._pos!.map(p => lerp(this._min, this._max, p))\n\t\t\t\t\t: [this._min, this._max]\n\t\t\t}\n\t\t\tthis._min = domain[0]\n\t\t\tthis._max = domain[domain.length - 1]\n\t\t\tif (2 == domain.length) {\n\t\t\t\tif (\"function\" !== typeof this._colors) {\n\t\t\t\t\t// equidistant positions\n\t\t\t\t\tthis._pos = this._colors.map((_, c) => c / (this._colors.length - 1))\n\t\t\t\t}\n\t\t\t} else if (\"function\" !== typeof this._colors && domain.length == this._colors.length) {\n\t\t\t\tthis._pos = domain.map(d => lerpInv(this._min, this._max, d))\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"invalid domain \" + domain)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Get the interpolation mode used when calculating colors.\n\t\t */\n\t\tpublic mode(): InterpolationMode\n\t\t/**\n\t\t * Set the interpolation mode used when calculating colors. The defaut mode is \"rgb\".\n\t\t * See also {@link chroma#mix}\n\t\t * @param mode the mode to set.\n\t\t * @return `this`\n\t\t * @example chroma.scale(\"red\", \"green\").mode(\"lab\")\n\t\t * @example chroma.scale(\"red\", \"green\").mode(\"lrgb\")\n\t\t */\n\t\tpublic mode(mode: InterpolationMode): this\n\t\tpublic mode(mode?: InterpolationMode) {\n\t\t\tif (undefined === mode) {\n\t\t\t\treturn this._mode\n\t\t\t}\n\t\t\tthis._mode = mode\n\t\t\tthis._resetCache()\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Set the output format return by `this(x)` and `this.colors(n)`.\n\t\t * @param outputFormat The color format to use. Pass `undefined` to return [Color] objects.\n\t\t * @return `this`\n\t\t * @example chroma.scale(\"red\", \"white\").out(\"hex\")(0) // == \"#ff0000\"\n\t\t * @example chroma.scale(\"red\", \"white\").out(\"num\").colors(2) // == [0xff0000, 0xffffff]\n\t\t */\n\t\tpublic out<M extends ColorFormat | undefined>(\n\t\t\toutputFormat: M,\n\t\t): Scale<M extends ColorFormat ? ReturnType<Color[M]> : Color> {\n\t\t\tthis._out = outputFormat\n\t\t\treturn this as any\n\t\t}\n\n\t\t/**\n\t\t * This makes sure the lightness range is spread evenly across a color scale. Especially useful when working\n\t\t * with [multi-hue color scales](https://www.vis4.net/blog/2013/09/mastering-multi-hued-color-scales/), where\n\t\t * simple gamma correction can't help you very much.\n\t\t *\n\t\t * @example chroma.scale('black','red','yellow','white')\n\t\t * @example chroma.scale('black','red','yellow','white').correctLightness()\n\t\t */\n\t\tpublic correctLightness(enableCorrectLightness = true) {\n\t\t\tif (this._correctLightness != enableCorrectLightness) {\n\t\t\t\tthis._resetCache()\n\t\t\t\tconst colors = this._colors\n\t\t\t\tif (enableCorrectLightness && \"function\" !== typeof colors) {\n\t\t\t\t\t// make sure that the colors have ascending or descending lightnesses\n\t\t\t\t\tlet sign = 0\n\t\t\t\t\tfor (let i = 1; i < colors.length; i++) {\n\t\t\t\t\t\tconst sign2 = colors[i].lab()[0] - colors[i - 1].lab()[0]\n\t\t\t\t\t\tif (0 == sign) {\n\t\t\t\t\t\t\tsign = sign2\n\t\t\t\t\t\t} else if (sign * sign2 < 0) {\n\t\t\t\t\t\t\tthrow new Error(\"scale color lightnesses must be monotonic\")\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._correctLightness = enableCorrectLightness\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Get the padding.\n\t\t * @returns [paddingLeft, paddingRight]\n\t\t */\n\t\tpublic padding(): [number, number]\n\t\t/**\n\t\t * Set the padding. Positive values will \"cut off\" the ends of gradient, while negative values will add a\n\t\t * section of constant color at the ends.\n\t\t * @example chroma.scale(\"red\", \"white\").padding(0.2)\n\t\t * @example chroma.scale(\"red\", \"white\").padding(0.1)(0) // == chroma('#ff1a1a'), instead of red\n\t\t * @example chroma.scale(\"red\", \"white\").padding(-0.1)(0) // == chroma('red')\n\t\t * @param paddingLeft padding on left side.(lower-valued end of the interval).\n\t\t * @param paddingRight padding on right (higher-valued end of the interval).\n\t\t * default=paddingLeft\n\t\t */\n\t\tpublic padding(paddingLeft: number, paddingRight?: number): this\n\t\tpublic padding(paddingLeft?: number, paddingRight: number | undefined = paddingLeft) {\n\t\t\tif (!paddingLeft) {\n\t\t\t\treturn [this._paddingLeft, this._paddingRight]\n\t\t\t}\n\t\t\tthis._paddingLeft = paddingLeft\n\t\t\tthis._paddingRight = paddingRight!\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Get a number of equidistant colors.\n\t\t * @param numColors The number of colors to return.\n\t\t * @param format Output format. Defaults to `\"hex\"`. Pass `false` to get {@link Color} objects.\n\t\t * @returns If `numColors` is `undefined`, the colors which define this [Scale]. If `numColors` is 1,\n\t\t * `[this((min + max) / 2)]`. Otherwise, an array where the first element is `this(min)`, the last one is\n\t\t * `this(max)` and the rest are equidistant samples between min and max.\n\t\t * @example chroma.scale('OrRd').colors(5)\n\t\t * @example chroma.scale(['white', 'black']).colors(12)\n\t\t */\n\t\tpublic colors(numColors?: number, format: ColorFormat | false = \"hex\"): T[] {\n\t\t\tlet result: Color[]\n\t\t\tif (undefined === numColors) {\n\t\t\t\tresult = (this._colors as Color[]).slice()\n\t\t\t} else if (numColors == 1) {\n\t\t\t\tresult = [this._color((this._min + this._max) / 2)]\n\t\t\t} else if (numColors > 1) {\n\t\t\t\tresult = Array.from({ length: numColors }, (_, i) =>\n\t\t\t\t\tthis._color(lerp(this._min, this._max, i / (numColors - 1))),\n\t\t\t\t)\n\t\t\t} else {\n\t\t\t\t// returns all colors based on the defined classes\n\t\t\t\tlet samples\n\t\t\t\tif (this._classes && this._classes.length > 2) {\n\t\t\t\t\tsamples = Array.from(\n\t\t\t\t\t\t{ length: this._classes.length - 1 },\n\t\t\t\t\t\t(_, i) => (this._classes![i] + this._classes![i + 1]) * 0.5,\n\t\t\t\t\t)\n\t\t\t\t} else {\n\t\t\t\t\tsamples = this.domain() // TODO?!\n\t\t\t\t}\n\t\t\t\tresult = samples.map(s => this._color(s))\n\t\t\t}\n\n\t\t\treturn (format ? result.map(c => c[format]()) : result) as any\n\t\t}\n\n\t\t/**\n\t\t * Get whether the cache is enabled. Defaults to true.\n\t\t */\n\t\tpublic cache(): boolean\n\t\t/**\n\t\t * Enable or disable the cache.\n\t\t * @param enableCache Whether the cache should be enabled.\n\t\t */\n\t\tpublic cache(enableCache: boolean): this\n\t\tpublic cache(enableCache?: boolean) {\n\t\t\tif (undefined === enableCache) {\n\t\t\t\treturn !!this._cache\n\t\t\t}\n\t\t\tthis._cache = enableCache ? this._cache || new Map() : undefined\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * Get the current gamma value. Defaults to 1.\n\t\t */\n\t\tpublic gamma(): number\n\t\t/**\n\t\t * Set the gamma value. Gamma-correction can be used to \"shift\" a scale's center more the the beginning (gamma <\n\t\t * 1) or end (gamma > 1), typically used to \"even\" the lightness gradient. Default is 1.\n\t\t * @example chroma.scale('YlGn').gamma(0.5)\n\t\t * @example chroma.scale('YlGn').gamma(1)\n\t\t * @example chroma.scale('YlGn').gamma(2)\n\t\t */\n\t\tpublic gamma(gamma: number): this\n\t\tpublic gamma(gamma?: number) {\n\t\t\tif (undefined === gamma) {\n\t\t\t\treturn this._gamma\n\t\t\t}\n\t\t\tthis._gamma = gamma\n\t\t\treturn this\n\t\t}\n\n\t\t/**\n\t\t * @ignore\n\t\t */\n\t\tpublic _at(t: number) {\n\t\t\tconst c = this._color(t)\n\t\t\treturn this._out ? c[this._out]() : c\n\t\t}\n\n\t\t/**\n\t\t * @ignore\n\t\t */\n\t\tpublic _init(colorsOrFunction: Color[] | ((t: number) => Color)) {\n\t\t\tthis._colors = colorsOrFunction\n\t\t\tif (\"function\" != typeof colorsOrFunction) {\n\t\t\t\tthis._pos = colorsOrFunction.map((_, i) => i / (colorsOrFunction.length - 1))\n\t\t\t}\n\t\t\tthis._mode = \"rgb\"\n\t\t\tthis.domain(0, 1)\n\t\t\tthis._paddingLeft = 0\n\t\t\tthis._paddingRight = 0\n\t\t\tthis._correctLightness = false\n\t\t\tthis._cache = new Map()\n\t\t\tthis._gamma = 1\n\t\t}\n\n\t\tprivate _getClass(value: number) {\n\t\t\treturn this._classes!.findIndex(cls => value <= cls) - 1\n\t\t}\n\n\t\tprivate _color(val: number, bypassMap = false) {\n\t\t\tlet t\n\t\t\tif (!bypassMap) {\n\t\t\t\tconst min = this._min,\n\t\t\t\t\tmax = this._max\n\t\t\t\tif (this._classes && this._classes.length > 2) {\n\t\t\t\t\tconst c = this._getClass(val)\n\t\t\t\t\tt = c / (this._classes.length - 2)\n\t\t\t\t} else if (max !== min) {\n\t\t\t\t\tt = (val - min) / (max - min)\n\t\t\t\t} else {\n\t\t\t\t\tt = 1\n\t\t\t\t}\n\t\t\t\tif (this._correctLightness) {\n\t\t\t\t\tt = this._tCorrectedLightness(t)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tt = val\n\t\t\t}\n\t\t\tt = t ** this._gamma\n\t\t\tt = (this._paddingLeft + t) / (1 + this._paddingLeft + this._paddingRight)\n\t\t\t//\tt = this._paddingLeft + t * (1 - this._paddingLeft - this._paddingRight)\n\t\t\tt = clamp(t, 0, 1)\n\t\t\tconst tHash = t\n\t\t\tconst cacheResult = this._cache && this._cache.get(tHash)\n\t\t\tif (cacheResult) {\n\t\t\t\treturn cacheResult\n\t\t\t} else {\n\t\t\t\tlet col: Color\n\t\t\t\tif (Array.isArray(this._colors)) {\n\t\t\t\t\tfor (let i = 0; i < this._pos!.length; i++) {\n\t\t\t\t\t\tconst p = this._pos![i]\n\t\t\t\t\t\tif (t <= p) {\n\t\t\t\t\t\t\tcol = this._colors[i]\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (t >= p && i == this._pos!.length - 1) {\n\t\t\t\t\t\t\tcol = this._colors[i]\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (t > p && t < this._pos![i + 1]) {\n\t\t\t\t\t\t\tt = (t - p) / (this._pos![i + 1] - p)\n\t\t\t\t\t\t\tcol = mix(this._colors[i], this._colors[i + 1], t, this._mode)\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcol = this._colors(t)\n\t\t\t\t}\n\t\t\t\tif (this._cache) {\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tthis._cache.set(tHash, col!)\n\t\t\t\t}\n\t\t\t\t// tslint:disable-next-line\n\t\t\t\treturn col!\n\t\t\t}\n\t\t}\n\t\tprivate _tCorrectedLightness(t0_1: number) {\n\t\t\tconst L0 = this._color(0, true).lab()[0]\n\t\t\tconst L1 = this._color(1, true).lab()[0]\n\t\t\tconst L_ideal = lerp(L0, L1, t0_1)\n\t\t\treturn bisect(t => this._color(t, true).lab()[0] - L_ideal, 0, 1, 8)\n\t\t}\n\t\tprivate _resetCache() {\n\t\t\tif (this._cache) this._cache.clear()\n\t\t}\n\t}\n\n\texport namespace scales {\n\t\t/**\n\t\t * @example chroma.scales.cool()\n\t\t */\n\t\texport function cool() {\n\t\t\treturn scale([hsl(180, 1, 0.9), hsl(250, 0.7, 0.4)])\n\t\t}\n\n\t\t/**\n\t\t * @example chroma.scales.hot()\n\t\t */\n\t\texport function hot() {\n\t\t\treturn scale([\"#000\", \"#f00\", \"#ff0\", \"#fff\"]).mode(\"rgb\")\n\t\t}\n\t}\n\n\t/**\n\t * Computes the WCAG contrast ratio between two colors. A minimum contrast of 4.5:1\n\t * [is recommended](http://www.w3.org/TR/WCAG20-TECHS/G18.html) to ensure that text is still readable against a\n\t * background color.\n\t *\n\t * @param a\n\t * @param b\n\t */\n\texport function contrast(a: Chromable, b: Chromable) {\n\t\tconst l1 = chroma(a).luminance()\n\t\tconst l2 = chroma(b).luminance()\n\t\tif (l1 > l2) {\n\t\t\treturn (l1 + 0.05) / (l2 + 0.05)\n\t\t} else {\n\t\t\treturn (l2 + 0.05) / (l1 + 0.05)\n\t\t}\n\t}\n\n\t/**\n\t * Compute the [euclidean distance](https://en.wikipedia.org/wiki/Euclidean_distance#Three_dimensions) between two\n\t * colors in a given color space.\n\t * @param a First color.\n\t * @param b Second color.\n\t * @param mode The color space in which to compute the distance. Defaults to \"lab\".\n\t * @example chroma.distance('#fff', '#ff0', 'rgb')\n\t * @example chroma.distance('#fff', '#f0f', 'rgb')\n\t * @example chroma.distance('#fff', '#ff0')\n\t * @example chroma.distance('#fff', '#f0f')\n\t */\n\texport function distance(a: Chromable, b: Chromable, mode: ColorMode = \"lab\") {\n\t\tconst l1 = chroma(a)[mode]()\n\t\tconst l2 = chroma(b)[mode]()\n\t\tconst channelDifferences = l1.map(\n\t\t\t(channelValue: number, channelIndex: number) => channelValue - l2[channelIndex],\n\t\t)\n\t\treturn hypot(...channelDifferences)\n\t}\n\n\t/**\n\t * Computes color difference as developed by the Colour Measurement Committee of the Society of Dyers and Colourists\n\t * (CMC) in 1984. The implementation is adapted from Bruce Lindbloom. The parameters L and C are weighting factors\n\t * for lightness and chromaticity.\n\t * @param reference\n\t * @param sample\n\t * @param L\n\t * @param C\n\t * @example [r = '#ededee', s = '#edeeed', chroma.deltaE(r, s)]\n\t * @example [r = '#ececee', s = '#eceeec', chroma.deltaE(r, s)]\n\t * @example [r = '#e9e9ee', s = '#e9eee9', chroma.deltaE(r, s)]\n\t * @example [r = '#e4e4ee', s = '#e4eee4', chroma.deltaE(r, s)]\n\t * @example [r = '#e0e0ee', s = '#e0eee0', chroma.deltaE(r, s)]\n\t */\n\texport function deltaE(reference: Chromable, sample: Chromable, L = 1, C = 1) {\n\t\tconst [L1, a1, b1] = chroma(reference).lab()\n\t\tconst [L2, a2, b2] = chroma(sample).lab()\n\t\tconst c1 = sqrt(a1 * a1 + b1 * b1)\n\t\tconst c2 = sqrt(a2 * a2 + b2 * b2)\n\t\tconst sl = L1 < 16.0 ? 0.511 : (0.040975 * L1) / (1.0 + 0.01765 * L1)\n\t\tconst sc = (0.0638 * c1) / (1.0 + 0.0131 * c1) + 0.638\n\t\tconst h1 = norm360(c1 < 0.000001 ? 0.0 : atan2(b1, a1) * RAD2DEG)\n\t\tconst t =\n\t\t\th1 >= 164.0 && h1 <= 345.0\n\t\t\t\t? 0.56 + abs(0.2 * cos((h1 + 168.0) * DEG2RAD))\n\t\t\t\t: 0.36 + abs(0.4 * cos((h1 + 35.0) * DEG2RAD))\n\t\tconst c4 = c1 * c1 * c1 * c1\n\t\tconst f = sqrt(c4 / (c4 + 1900.0))\n\t\tconst sh = sc * (f * t + 1.0 - f)\n\t\tconst delL = L1 - L2\n\t\tconst delC = c1 - c2\n\t\tconst delA = a1 - a2\n\t\tconst delB = b1 - b2\n\t\tconst dH2 = delA * delA + delB * delB - delC * delC\n\t\tconst v1 = delL / (L * sl)\n\t\tconst v2 = delC / (C * sc)\n\t\tconst v3 = sh\n\t\treturn sqrt(v1 * v1 + v2 * v2 + dH2 / (v3 * v3))\n\t}\n\ttype DataInfo = {\n\t\tmin: number\n\t\tmax: number\n\t\tsum: number\n\t\tvalues: number[]\n\t\tcount: number\n\t\tdomain: [number, number]\n\t\tlimits(mode: LimitsMode, num: number): number[]\n\t}\n\texport function analyze(data: number[]): DataInfo {\n\t\tconst r: DataInfo = {\n\t\t\tmin: Infinity,\n\t\t\tmax: -Infinity,\n\t\t\tsum: 0,\n\t\t\tvalues: [] as number[],\n\t\t\tcount: 0,\n\t\t} as DataInfo\n\t\tfunction add(val: number) {\n\t\t\tif (val != undefined && !isNaN(val)) {\n\t\t\t\tr.values.push(val)\n\t\t\t\tr.sum += val\n\t\t\t\tif (val < r.min) r.min = val\n\t\t\t\tif (val > r.max) r.max = val\n\t\t\t\tr.count += 1\n\t\t\t}\n\t\t}\n\t\tdata.forEach(val => add(val))\n\t\tr.domain = [r.min, r.max]\n\t\tr.limits = function(mode, num) {\n\t\t\treturn limits(this, mode, num)\n\t\t}\n\t\treturn r\n\t}\n\n\ttype LimitsMode = \"c\" | \"e\" | \"q\" | \"l\" | \"k\"\n\texport function limits(data: number[] | DataInfo, mode: LimitsMode = \"e\", num = 7): number[] {\n\t\tconst info = Array.isArray(data) ? analyze(data) : data\n\t\tconst { min, max, values } = info\n\t\tvalues.sort((a, b) => a - b)\n\t\tif (num == 1) {\n\t\t\treturn [min, max]\n\t\t}\n\t\tif (mode.startsWith(\"c\")) {\n\t\t\treturn [min, max]\n\t\t} else if (mode.startsWith(\"e\")) {\n\t\t\treturn Array.from({ length: num + 1 }, (_, i) => lerp(min, max, i / num))\n\t\t} else if (mode.startsWith(\"l\")) {\n\t\t\tif (min <= 0) {\n\t\t\t\tthrow new Error(\"Logarithmic scales are only possible for values > 0\")\n\t\t\t}\n\t\t\tconst min_log = Math.LOG10E * log(min)\n\t\t\tconst max_log = Math.LOG10E * log(max)\n\t\t\treturn Array.from({ length: num + 1 }, (_, i) => 10 ** lerp(min_log, max_log, i / num))\n\t\t} else if (mode.startsWith(\"q\")) {\n\t\t\treturn Array.from({ length: num + 1 }, (_, i) => {\n\t\t\t\tconst p = ((values.length - 1) * i) / num\n\t\t\t\tconst pb = floor(p)\n\t\t\t\treturn pb == p ? values[pb] : lerp(values[pb], values[pb + 1], p - pb)\n\t\t\t})\n\t\t} else if (mode.startsWith(\"k\")) {\n\t\t\t// implementation based on\n\t\t\t// http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n\t\t\t// simplified for 1-d input values\n\t\t\tconst n = values.length\n\t\t\tconst assignments = new Array(n)\n\t\t\tconst clusterSizes = new Array(num)\n\t\t\tlet repeat = true\n\t\t\tlet nb_iters = 0\n\t\t\tlet centroids = Array.from({ length: num + 1 }, (_, i) => lerp(min, max, i / num))\n\t\t\tdo {\n\t\t\t\t// assignment step\n\t\t\t\tclusterSizes.fill(0)\n\t\t\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\t\t\tconst value = values[i]\n\t\t\t\t\tconst minDistIndex = indexOfMax(centroids, c => -abs(c - value))\n\t\t\t\t\tclusterSizes[minDistIndex]++\n\t\t\t\t\tassignments[i] = minDistIndex\n\t\t\t\t}\n\n\t\t\t\t// update centroids step\n\t\t\t\tconst newCentroids = new Array(num).fill(0)\n\t\t\t\tfor (let i = 0; i < assignments.length; i++) {\n\t\t\t\t\tconst cluster = assignments[i]\n\t\t\t\t\tnewCentroids[cluster] += values[i]\n\t\t\t\t}\n\t\t\t\tfor (let j = 0; j < newCentroids.length; j++) {\n\t\t\t\t\tnewCentroids[j] /= clusterSizes[j]\n\t\t\t\t}\n\n\t\t\t\t// check convergence\n\t\t\t\trepeat = newCentroids.some((nc, j) => nc != centroids[j])\n\t\t\t\tcentroids = newCentroids\n\t\t\t} while (nb_iters++ < 200 && repeat)\n\n\t\t\t// finished k-means clustering\n\t\t\t// the next part is borrowed from gabrielflor.it\n\t\t\tconst kClusters: number[][] = Array.from({ length: num }, () => [])\n\t\t\tfor (let i = 0; i < assignments.length; i++) {\n\t\t\t\tconst cluster = assignments[i]\n\t\t\t\tkClusters[cluster].push(values[i])\n\t\t\t}\n\t\t\tconst tmpKMeansBreaks = []\n\t\t\tfor (const kCluster of kClusters) {\n\t\t\t\ttmpKMeansBreaks.push(kCluster[0], kCluster[kCluster.length - 1])\n\t\t\t}\n\t\t\ttmpKMeansBreaks.sort((a, b) => a - b)\n\n\t\t\tconst limits = []\n\t\t\tlimits.push(tmpKMeansBreaks[0])\n\t\t\tfor (let i = 1; i < tmpKMeansBreaks.length; i += 2) {\n\t\t\t\tconst v = tmpKMeansBreaks[i]\n\t\t\t\tif (!isNaN(v) && limits.indexOf(v) == -1) {\n\t\t\t\t\tlimits.push(v)\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn limits\n\t\t} else {\n\t\t\tthrow new Error(\"unknown mode\")\n\t\t}\n\t}\n}\n\nconst interpolators: {\n\t[K in InterpolationMode]?: (color1: chroma.Color, color2: chroma.Color, f: number, mode: K) => chroma.Color\n} = {}\n\n// const _guess_formats: { p: number; test: (args: any[]) => ColorFormat | undefined }[] = []\nconst _input: {\n\t[mode: string]: (...args: any[]) => RGB | RGBA\n} = {}\n\nfunction linear_interpolator(col1: chroma.Color, col2: chroma.Color, f: number, m: ColorMode) {\n\tconst xyz1 = col1[m]()\n\tconst xyz2 = col2[m]()\n\treturn guess(\n\t\t[\n\t\t\tlerp(xyz1[0], xyz2[0], f),\n\t\t\tlerp(xyz1[1], xyz2[1], f),\n\t\t\tlerp(xyz1[2], xyz2[2], f),\n\t\t\tlerp(col1.alpha(), col2.alpha(), f),\n\t\t],\n\t\tm,\n\t)\n}\ninterpolators.xyz = interpolators.rgb = interpolators.lab = linear_interpolator\n\ninterpolators.num = function(col1, col2, f) {\n\tconst n1 = col1.num()\n\tconst n2 = col2.num()\n\treturn chroma.num(lerp(n1, n2, f))\n}\n\ninterpolators.lrgb = function(col1, col2, f) {\n\tconst [r1, g1, b1, a1] = col1.rgba(false, false)\n\tconst [r2, g2, b2, a2] = col2.rgba(false, false)\n\treturn new chroma.Color(\n\t\tsqrt(r1 ** 2 * (1 - f) + r2 ** 2 * f),\n\t\tsqrt(g1 ** 2 * (1 - f) + g2 ** 2 * f),\n\t\tsqrt(b1 ** 2 * (1 - f) + b2 ** 2 * f),\n\t\tlerp(a1, a2, f),\n\t)\n}\n\nfunction _bezier(chromables: chroma.Chromable[]): (t: number) => chroma.Color {\n\tconst colors = chromables.map(c => chroma(c))\n\tconst [lab0, lab1, lab2, lab3] = colors.map(c => c.lab())\n\tif (2 == chromables.length) {\n\t\t// linear interpolation\n\t\treturn t => {\n\t\t\treturn chroma.lab([0, 1, 2].map(i => lerp(lab0[i], lab1[i], t)) as LAB)\n\t\t}\n\t} else if (3 == chromables.length) {\n\t\t// quadratic bezier interpolation\n\t\tconst bezier2 = (p0: number, p1: number, p2: number, t: number) =>\n\t\t\t(1 - t) ** 2 * p0 + 2 * (1 - t) * t * p1 + t ** 2 * p2\n\t\treturn t => chroma.lab([0, 1, 2].map(i => bezier2(lab0[i], lab1[i], lab2[i], t)) as LAB)\n\t} else if (4 == chromables.length) {\n\t\t// cubic bezier interpolation\n\t\tconst bezier3 = (p0: number, p1: number, p2: number, p3: number, t: number) =>\n\t\t\t(1 - t) ** 3 * p0 + 3 * (1 - t) ** 2 * t * p1 + 3 * (1 - t) * t ** 2 * p2 + t ** 3 * p3\n\t\treturn t => chroma.lab([0, 1, 2].map(i => bezier3(lab0[i], lab1[i], lab2[i], lab3[i], t)) as LAB)\n\t} else if (5 == chromables.length) {\n\t\tconst I0 = _bezier(colors.slice(0, 3))\n\t\tconst I1 = _bezier(colors.slice(2, 5))\n\t\treturn t => (t < 0.5 ? I0(t * 2) : I1((t - 0.5) * 2))\n\t} else throw new Error()\n}\n\nfunction guess(args: any[], mode?: ColorFormat): chroma.Color {\n\tif (Array.isArray(args[0])) args = args[0]\n\tif (!mode) {\n\t\tif (args.length == 1 && args[0] in chroma.w3cx11) {\n\t\t\tmode = \"name\"\n\t\t} else if (args.length == 1 && \"string\" == typeof args[0]) {\n\t\t\tmode = \"css\"\n\t\t} else if (args.length == 3) {\n\t\t\tmode = \"rgb\"\n\t\t} else if (args.length == 4 && \"number\" == typeof args[3] && args[3] >= 0 && args[3] <= 1) {\n\t\t\tmode = \"rgb\"\n\t\t} else if (args.length == 1 && \"number\" == typeof args[0] && args[0] >= 0 && args[0] <= 0xffffff) {\n\t\t\tmode = \"num\"\n\t\t} else throw new Error(\"could not guess mode. args \" + JSON.stringify(args))\n\t}\n\tconst channels = _input[mode](...args)\n\treturn new chroma.Color(channels[0], channels[1], channels[2], undefined !== channels[3] ? channels[3] : 1)\n}\n\nfunction _average_lrgb(colors: chroma.Color[]) {\n\tlet rSquareSum = 0,\n\t\tgSquareSum = 0,\n\t\tbSquareSum = 0,\n\t\talphaSum = 0\n\tfor (const col of colors) {\n\t\tconst [r, g, b, alpha] = col.rgba(false, false)\n\t\trSquareSum += r ** 2\n\t\tgSquareSum += g ** 2\n\t\tbSquareSum += b ** 2\n\t\talphaSum += alpha\n\t}\n\treturn new chroma.Color(\n\t\tsqrt(rSquareSum) / colors.length,\n\t\tsqrt(gSquareSum) / colors.length,\n\t\tsqrt(bSquareSum) / colors.length,\n\t\talphaSum / colors.length,\n\t)\n}\n\nfunction hex2rgb(hex: string): RGBA {\n\tlet m\n\tif ((m = hex.match(/^#?([A-F\\d]{2})([A-F\\d]{2})([A-F\\d]{2})([A-F\\d]{2})?$/i))) {\n\t\treturn [parseInt(m[1], 16), parseInt(m[2], 16), parseInt(m[3], 16), m[4] ? parseInt(m[4], 16) / 255 : 1]\n\t} else if ((m = hex.match(/^#?([A-F\\d])([A-F\\d])([A-F\\d])([A-F\\d])?$/i))) {\n\t\treturn [\n\t\t\tparseInt(m[1], 16) * 0x11,\n\t\t\tparseInt(m[2], 16) * 0x11,\n\t\t\tparseInt(m[3], 16) * 0x11,\n\t\t\tm[4] ? (parseInt(m[4], 16) * 0x11) / 255 : 1,\n\t\t]\n\t}\n\tthrow new Error(\"invalid hex color: \" + hex)\n}\n// color mode, i.e. representation as array of number\nexport type ColorMode = \"rgb\" | \"cmyk\" | \"lab\" | \"hsv\" | \"hsi\" | \"hcg\" | \"hsl\" | \"gl\" | \"lch\" | \"xyz\"\nexport type InterpolationMode = \"rgb\" | \"lab\" | \"hsv\" | \"hsi\" | \"hcg\" | \"hsl\" | \"lch\" | \"xyz\" | \"lrgb\" | \"num\"\nexport type ColorFormat = ColorMode | \"hex\" | \"num\" | \"name\" | \"kelvin\" | \"css\"\n/**\n * CMYK color space\n * @see https://en.wikipedia.org/wiki/cmyk_color_model\n * [cyan, magenta, yellow, alpha1]\n */\ntype CMYK = [number, number, number, number]\n/**\n * WebGL colors. Like RGB, but floats in [0; 1] instead of 0-255.\n * [red255, green255, blue255, alpha1]\n */\ntype GL = [number, number, number, number]\n/**\n * Red, green, blue ranging from 0-255.\n * Can be floats and outside the above range internally.\n */\ntype RGB = [number, number, number]\n/**\n * RGB plus alpha ranging from 0-1\n * [red255, green255, blue255, alpha1]\n */\ntype RGBA = [number, number, number, number]\n/**\n * CIELAB color space\n * [lightness, A*, B*]\n * @see https://en.wikipedia.org/wiki/CIELAB_color_space\n */\ntype LAB = [number, number, number]\n/**\n * Cylindrical representation of CIELAB\n * @see https://en.wikipedia.org/wiki/CIELAB_color_space#Cylindrical_representation:_CIELCh_or_CIEHLC\n *\n */\ntype LCH = [number, number, number]\n/**\n * @see https://en.wikipedia.org/wiki/HSL_and_HSV\n * [hueDegrees, saturation1, lightness1]\n */\ntype HSL = [number, number, number]\n/**\n * @see https://en.wikipedia.org/wiki/HSL_and_HSV\n * [hueDegrees, saturation1, value1]\n */\ntype HSV = [number, number, number]\n/**\n * @see https://en.wikipedia.org/w/index.php?title=HSI_color_space&redirect=no\n * [hueDegrees, saturation1, intensity1]\n */\ntype HSI = [number, number, number]\ntype XYZ = [number, number, number]\n/**\n * HCG Color Model\n * See https://github.com/acterhd/hcg-color\n * A color value in the HCG format is an array of three numbers [h, c, g], where\n * `h` is the hue as an angle in degrees [0; 360)\n * `c` is the chroma value in [0; 1]\n * `g` is the gray value in [0; 1]\n */\ntype HCG = [number, number, number]\n\n// interface ColorModes {\n// \tcmyk: CMYK\n// \tgl: GL\n// \trgb: RGB\n// \trgba: RGBA\n// \tlab: LAB\n// \thsl: HSL\n// \thsv: HSV\n// \thsi: HSI\n// \txyz: XYZ\n// \thcg: HCG\n// \tlch: LCH\n// \thex: string\n// \tnum: number\n// \tname: string\n// \tkelvin: number\n// \tcss: string\n// }\nfunction rgb2hex(r255: number, g255: number, b255: number, a1: number, mode: \"rgb\" | \"rgba\" | \"argb\" = \"rgb\") {\n\tr255 = clamp(round(r255), 0, 255)\n\tg255 = clamp(round(g255), 0, 255)\n\tb255 = clamp(round(b255), 0, 255)\n\tconst rgb = (r255 << 16) | (g255 << 8) | b255\n\tconst rgbString = rgb.toString(16).padStart(6, \"0\")\n\tconst alphaString = round(clamp(a1) * 255)\n\t\t.toString(16)\n\t\t.padStart(2, \"0\")\n\treturn \"#\" + (\"argb\" == mode ? alphaString + rgbString : \"rgba\" == mode ? rgbString + alphaString : rgbString)\n}\n\n_input.lrgb = _input.rgb\n\n_input.hex = hex2rgb\n_input.hsl = hsl2rgb\nfunction norm360(degrees: number) {\n\treturn ((degrees % 360) + 360) % 360\n}\n\n_input.hsv = hsv2rgb\n\nfunction num2rgb(num: number): RGBA {\n\tif (!(\"number\" == typeof num && num >= 0 && num <= 0xffffff)) {\n\t\tthrow new Error(\"unknown num color: \" + num)\n\t}\n\tconst r = num >> 16\n\tconst g = (num >> 8) & 0xff\n\tconst b = num & 0xff\n\treturn [r, g, b, 1]\n}\n\nfunction rgb2num(r255: number, g255: number, b255: number, a1: number = 1, mode: \"rgb\" | \"rgba\" | \"argb\" = \"rgb\") {\n\tconst rgbNum = (round(r255) << 16) | (round(g255) << 8) | round(b255)\n\tif (\"rgb\" === mode) {\n\t\treturn rgbNum\n\t} else if (\"rgba\" === mode) {\n\t\treturn (rgbNum << 8) | (round(a1 * 255) << 24)\n\t} else {\n\t\treturn (round(a1 * 255) << 24) | rgbNum\n\t}\n}\n\n_input.num = num2rgb\n\nconst WS = \"\\\\s*\"\nconst FLOAT = \"([+-]?(?:\\\\d*\\\\.?)?\\\\d+(?:[eE][+-]?\\\\d+)?)\"\nconst CSS_RGB_REGEX = new RegExp(\n\t[\"^rgba?\\\\(\", FLOAT, \",\", FLOAT, \",\", FLOAT, \"(?:,\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(WS),\n\t\"i\",\n)\nconst CSS_RGB_WS_REGEX = new RegExp([\"^rgba?\\\\(\", FLOAT, FLOAT, FLOAT, \"(?:/\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(WS), \"i\")\nconst CSS_RGB_PERCENT_REGEX = new RegExp(\n\t[\"^rgba?\\\\(\", FLOAT + \"%\", \",\", FLOAT + \"%\", \",\", FLOAT + \"%\", \"(?:,\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(WS),\n\t\"i\",\n)\nconst CSS_RGB_WS_PERCENT_REGEX = new RegExp(\n\t[\"^rgba?\\\\(\", FLOAT + \"%\", FLOAT + \"%\", FLOAT + \"%\", \"(?:/\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(WS),\n\t\"i\",\n)\nconst CSS_HSL_REGEX = new RegExp(\n\t[\"^hsla?\\\\(\", FLOAT + \"(deg|rad|turn)?\", \",\", FLOAT + \"%\", \",\", FLOAT + \"%\", \"(?:,\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(\n\t\tWS,\n\t),\n\t\"i\",\n)\nconst CSS_HSL_WS_REGEX = new RegExp(\n\t[\"^hsla?\\\\(\", FLOAT + \"(deg|rad|turn)?\\\\s+\" + FLOAT + \"%\", FLOAT + \"%\", \"(?:/\", FLOAT + \"(%)?\", \")?\\\\)$\"].join(WS),\n\t\"i\",\n)\nfunction css2rgb(css: string): RGBA {\n\tif (chroma.w3cx11 && (chroma.w3cx11 as any)[css.toLowerCase()]) {\n\t\treturn num2rgb((chroma.w3cx11 as any)[css.toLowerCase()])\n\t}\n\tlet m\n\tif ((m = css.match(CSS_RGB_REGEX) || css.match(CSS_RGB_WS_REGEX))) {\n\t\treturn [\n\t\t\tclamp(+m[1], 0, 255),\n\t\t\tclamp(+m[2], 0, 255),\n\t\t\tclamp(+m[3], 0, 255),\n\t\t\tm[4] ? clamp(m[5] ? +m[4] / 100 : +m[4]) : 1,\n\t\t]\n\t} else if ((m = css.match(CSS_RGB_PERCENT_REGEX) || css.match(CSS_RGB_WS_PERCENT_REGEX))) {\n\t\treturn [\n\t\t\tclamp(+m[1] / 100) * 255,\n\t\t\tclamp(+m[2] / 100) * 255,\n\t\t\tclamp(+m[3] / 100) * 255,\n\t\t\tm[4] ? clamp(m[5] ? +m[4] / 100 : +m[4]) : 1,\n\t\t]\n\t} else if ((m = css.match(CSS_HSL_REGEX) || css.match(CSS_HSL_WS_REGEX))) {\n\t\tconst CONVERSION = { deg: 1, rad: RAD2DEG, turn: 360 }\n\t\tconst angleUnit = (m[2] ? m[2].toLowerCase() : \"deg\") as \"deg\" | \"rad\" | \"turn\"\n\t\treturn hsl2rgb(\n\t\t\t(((+m[1] * CONVERSION[angleUnit]) % 360) + 360) % 360,\n\t\t\tclamp(+m[3] / 100),\n\t\t\tclamp(+m[4] / 100),\n\t\t\tm[5] ? clamp(m[6] ? +m[5] / 100 : +m[5]) : 1,\n\t\t)\n\t} else {\n\t\treturn hex2rgb(css)\n\t}\n}\n\nfunction rgb2css(r: number, g: number, b: number, a = 1) {\n\tif (a >= 1) {\n\t\treturn \"rgb(\" + [r, g, b].map(round).join(\",\") + \")\"\n\t} else {\n\t\treturn \"rgba(\" + [r, g, b].map(round).join(\",\") + \",\" + a + \")\"\n\t}\n}\n\nfunction rnd(a: any) {\n\treturn round(a * 100) / 100\n}\n\nfunction hsl2css([h, s, l]: HSL, alpha: number) {\n\tconst mode = alpha < 1 ? \"hsla\" : \"hsl\"\n\treturn (\n\t\tmode +\n\t\t\"(\" +\n\t\trnd(h) +\n\t\t\",\" +\n\t\trnd(s * 100) +\n\t\t\"%\" +\n\t\t\",\" +\n\t\trnd(l * 100) +\n\t\t\"%\" +\n\t\t(\"hsla\" == mode ? \",\" + rnd(alpha) : \"\") +\n\t\t\")\"\n\t)\n}\n\n_input.css = css2rgb\n\n_input.name = function(name) {\n\treturn num2rgb((chroma.w3cx11 as any)[name])\n}\n\nfunction lch2lab(l: number, c: number, hueDegrees: number): LAB {\n\t/*\n    Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n    These formulas were invented by David Dalrymple to obtain maximum contrast without going\n    out of gamut if the parameters are in the range 0-1.\n\n    A saturation multiplier was added by Gregor Aisch\n     */\n\treturn [l, cos(hueDegrees * DEG2RAD) * c, sin(hueDegrees * DEG2RAD) * c]\n}\n\nfunction lch2rgb(l: number, c: number, hDegrees: number, alpha1 = 1): RGBA {\n\tconst [, a, b] = lch2lab(l, c, hDegrees)\n\treturn cielab2rgb(l, a, b, alpha1)\n}\n\nfunction lab2lch(l: number, a: number, b: number): LCH {\n\tconst c = hypot(a, b)\n\tconst h = (atan2(b, a) * RAD2DEG + 360) % 360\n\treturn [l, c, h]\n}\n\nfunction rgb2lch(r255: number, g255: number, b255: number) {\n\tconst [l, a, b2] = rgb2lab(r255, g255, b255)\n\treturn lab2lch(l, a, b2)\n}\n\n_input.lch = lch2rgb\n\nfunction rgb2cmyk(r255: number, g255: number, b255: number): CMYK {\n\tr255 /= 255\n\tg255 /= 255\n\tb255 /= 255\n\tconst k = 1 - max(r255, g255, b255)\n\tif (1 == k) return [0, 0, 0, 1]\n\tconst c = (1 - r255 - k) / (1 - k)\n\tconst m = (1 - g255 - k) / (1 - k)\n\tconst y = (1 - b255 - k) / (1 - k)\n\treturn [c, m, y, k]\n}\n\nfunction cmyk2rgb(c1: number, m1: number, y1: number, k1: number, alpha1 = 1): RGBA {\n\tif (k1 == 1) {\n\t\treturn [0, 0, 0, alpha1]\n\t}\n\tconst r255 = 255 * (1 - c1) * (1 - k1)\n\tconst g255 = 255 * (1 - m1) * (1 - k1)\n\tconst b255 = 255 * (1 - y1) * (1 - k1)\n\treturn [r255, g255, b255, alpha1]\n}\n\n_input.cmyk = cmyk2rgb\n\n_input.gl = function(r: number, g: number, b: number, a: number = 1): RGBA {\n\treturn [r * 255, g * 255, b * 255, a]\n}\n\n//function rgb2luminance(r: number, g: number, b: number) {\n//\t// https://en.wikipedia.org/wiki/Relative_luminance\n//\tconst [, Y] = rgb2xyz(r, g, b)\n//\treturn Y\n//}\n\nfunction rgbChannel2RgbLinear(x255: number) {\n\tconst x1 = x255 / 255\n\t// http://entropymine.com/imageworsener/srgbformula/\n\tif (x1 <= 0.04045) {\n\t\treturn x1 / 12.92\n\t} else {\n\t\treturn ((x1 + 0.055) / 1.055) ** 2.4\n\t}\n}\nfunction rgbLinearChannel2Rgb(xLinear1: number) {\n\tif (xLinear1 <= 0.0031308) {\n\t\treturn 255 * (12.92 * xLinear1)\n\t} else {\n\t\treturn 255 * ((1 + 0.055) * xLinear1 ** (1 / 2.4) - 0.055)\n\t}\n}\n\nfunction kelvin2rgb(kelvin: number): RGB {\n\tconst t = kelvin / 100\n\tlet r, g, b\n\tif (t < 66) {\n\t\tr = 255\n\t\tg = -155.25485562709179 - 0.44596950469579133 * (t - 2) + 104.49216199393888 * log(t - 2)\n\t\tb = t < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (t - 10) + 115.67994401066147 * log(t - 10)\n\t} else {\n\t\tr = 351.97690566805693 + 0.114206453784165 * (t - 55) - 40.25366309332127 * log(t - 55)\n\t\tg = 325.4494125711974 + 0.07943456536662342 * (t - 50) - 28.0852963507957 * log(t - 50)\n\t\tb = 255\n\t}\n\treturn [r, g, b]\n}\n\n_input.rgb = (...args: number[]) => args as RGB\n\nfunction rgb2kelvin(r255: number, g255: number, b255: number) {\n\tconsole.log(b255 - r255)\n\tif (g255 + b255 < 158.61) {\n\t\tconsole.log(\"0 < t < 20\")\n\t\t// calc from green\n\t\treturn round(\n\t\t\tnewtonIterate1d(\n\t\t\t\tt => g255 - (-155.25485562709179 - 0.44596950469579133 * (t - 2) + 104.49216199393888 * log(t - 2)),\n\t\t\t\t15,\n\t\t\t\t4,\n\t\t\t) * 100,\n\t\t)\n\t\treturn (Math.E ** ((g255 + 155.25485562709179 + 0.44596950469579133 * (15 - 2)) / 104.49216199393888) + 2) * 100\n\t} else if (b255 - r255 < 0) {\n\t\tconsole.log(\"20 < t < 66\")\n\t\treturn round(\n\t\t\tnewtonIterate1d(\n\t\t\t\tt => b255 - (-254.76935184120902 + 0.8274096064007395 * (t - 10) + 115.67994401066147 * log(t - 10)),\n\t\t\t\t43,\n\t\t\t\t4,\n\t\t\t) * 100,\n\t\t)\n\t\treturn (\n\t\t\t(Math.E ** ((b255 + 254.76935184120902 - 0.8274096064007395 * (43 - 10)) / 115.67994401066147) + 10) * 100\n\t\t)\n\t} else {\n\t\tconsole.log(\"0 < t < 400, start= \" + (-1.4 * (r255 + g255) + 755))\n\t\treturn round(\n\t\t\tnewtonIterate1d(\n\t\t\t\tt => r255 - (351.97690566805693 + 0.114206453784165 * (t - 55) - 40.25366309332127 * log(t - 55)),\n\t\t\t\t-1.4 * (r255 + g255) + 755,\n\t\t\t\t8,\n\t\t\t) * 100,\n\t\t)\n\t\treturn ((r255 / 329.698727446) ** (1 / -0.1332047592) + 60) * 100\n\t}\n\treturn newtonIterate1d(\n\t\tk => {\n\t\t\tconst eps = 1e-9\n\t\t\tconst [kr, kg, kb] = kelvin2rgb(k)\n\t\t\tconst [kr2, kg2, kb2] = kelvin2rgb(k + eps)\n\t\t\tconst dkr = (kr2 - kr) / eps,\n\t\t\t\tdkg = (kg2 - kg) / eps,\n\t\t\t\tdkb = (kb2 - kb) / eps\n\t\t\treturn dkr * (kr - r255) + dkg * (kg - g255) + dkb * (kb - b255)\n\n\t\t\treturn kb / kr - b255 / r255\n\t\t},\n\t\t//1000,\n\t\t//40000,\n\t\tMath.E ** ((b255 / r255 + 2.5) / 0.4),\n\t\t20,\n\t\t//1e-6,\n\t)\n\tlet maxTemp = 40000\n\tlet minTemp = 1000\n\tconst eps = 0.4\n\tlet temp: number = 0\n\tlet rgb\n\twhile (maxTemp - minTemp > eps) {\n\t\ttemp = (maxTemp + minTemp) * 0.5\n\t\trgb = kelvin2rgb(temp)\n\t\tif (rgb[2] / rgb[0] >= b255 / r255) {\n\t\t\tmaxTemp = temp\n\t\t} else {\n\t\t\tminTemp = temp\n\t\t}\n\t}\n\treturn round(temp)\n}\n\n_input.temperature = _input.kelvin = _input.K = kelvin2rgb\n\nfunction blend_f(f: (c1: RGB, c2: RGB) => RGB) {\n\treturn function(bottom: chroma.Chromable, top: chroma.Chromable) {\n\t\tconst [r, g, b] = f(chroma(top).rgb(), chroma(bottom).rgb())\n\t\treturn chroma.rgb(r, g, b)\n\t}\n}\n\nfunction each(f: (a: number, b: number) => number) {\n\treturn function(c1: RGB, c2: RGB): RGB {\n\t\treturn c1.map((e, i) => f(e, c2[i])) as RGB\n\t}\n}\n\nfunction _screen(a: number, b: number) {\n\treturn 255 * (1 - (1 - a / 255) * (1 - b / 255))\n}\n\nfunction _overlay(a: number, b: number) {\n\tif (b < 128) {\n\t\treturn (2 * a * b) / 255\n\t} else {\n\t\treturn 255 * (1 - 2 * (1 - a / 255) * (1 - b / 255))\n\t}\n}\n\nfunction _burn(a: number, b: number) {\n\treturn 255 * (1 - (1 - b / 255) / (a / 255))\n}\n\nfunction _dodge(a: number, b: number) {\n\tif (a == 255) {\n\t\treturn 255\n\t}\n\treturn 255 * min(1, b / 255 / (1 - a / 255))\n}\n\n/**\n * r, g, b can be in any interval (0-1 or 0-255)\n * @param r\n * @param g\n * @param b\n */\nfunction rgb2hexhue(r: number, g: number, b: number) {\n\tconst m = min(r, g, b)\n\tconst M = max(r, g, b)\n\tconst delta = M - m\n\tlet hueTurnX6 // angle as value between 0 and 6\n\tif (0 == delta) {\n\t\thueTurnX6 = 0\n\t} else if (r == M) {\n\t\t// second term to make sure the value is > 0\n\t\thueTurnX6 = (g - b) / delta + (g < b ? 6 : 0)\n\t} else if (g == M) {\n\t\thueTurnX6 = 2 + (b - r) / delta\n\t} else {\n\t\thueTurnX6 = 4 + (r - g) / delta\n\t}\n\treturn [hueTurnX6 * 60, m, M]\n}\nfunction hcxm2rgb(hueDegrees: number, c1: number, x1: number, m1: number, alpha1: number): RGBA {\n\tconst m255 = m1 * 255\n\tconst cm255 = c1 * 255 + m255\n\tconst xm255 = x1 * 255 + m255\n\tif (hueDegrees < 60) {\n\t\treturn [cm255, xm255, m255, alpha1]\n\t} else if (hueDegrees < 120) {\n\t\treturn [xm255, cm255, m255, alpha1]\n\t} else if (hueDegrees < 180) {\n\t\treturn [m255, cm255, xm255, alpha1]\n\t} else if (hueDegrees < 240) {\n\t\treturn [m255, xm255, cm255, alpha1]\n\t} else if (hueDegrees < 300) {\n\t\treturn [xm255, m255, cm255, alpha1]\n\t} else {\n\t\treturn [cm255, m255, xm255, alpha1]\n\t}\n}\n\n/**\n * https://en.wikipedia.org/w/index.php?title=HSL_and_HSV&oldid=856714654#From_HSL\n */\nfunction hsl2rgb(hueDegrees: number, s1: number, l1: number, alpha1 = 1): RGBA {\n\thueDegrees = norm360(hueDegrees)\n\tconst c1 = (1 - abs(2 * l1 - 1)) * s1\n\treturn hcxm2rgb(hueDegrees, c1, c1 * (1 - abs(((hueDegrees / 60) % 2) - 1)), l1 - c1 / 2, alpha1)\n}\nfunction rgb2hsl(r255: number, g255: number, b255: number): HSL {\n\tconst [hue, min1, max1] = rgb2hexhue(r255 / 255, g255 / 255, b255 / 255)\n\tconst l1 = (max1 + min1) / 2\n\tlet s1: number\n\tif (max1 == min1) {\n\t\ts1 = 0\n\t} else {\n\t\ts1 = l1 < 0.5 ? (max1 - min1) / (max1 + min1) : (max1 - min1) / (2 - max1 - min1)\n\t}\n\treturn [hue, s1, l1]\n}\n\nfunction hsv2rgb(hueDegrees: number, s1: number, v1: number, alpha1: number = 1): RGBA {\n\thueDegrees = norm360(hueDegrees)\n\tconst c1 = v1 * s1\n\treturn hcxm2rgb(hueDegrees, c1, c1 * (1 - abs(((hueDegrees / 60) % 2) - 1)), v1 - c1, alpha1)\n}\n\nfunction rgb2hsv(r255: number, g255: number, b255: number): HSV {\n\tconst [hue, min255, max255] = rgb2hexhue(r255, g255, b255)\n\tconst delta255 = max255 - min255\n\tconst v1 = max255 / 255.0\n\tconst s1 = max255 == 0 ? 0 : delta255 / max255\n\treturn [hue, s1, v1]\n}\n\nfunction hcg2rgb(hueDegrees: number, c1: number, g1: number, alpha1 = 1): RGBA {\n\thueDegrees = norm360(hueDegrees)\n\tconst p = g1 * (1 - c1)\n\treturn hcxm2rgb(hueDegrees, c1, c1 * (1 - abs(((hueDegrees / 60) % 2) - 1)), p, alpha1)\n}\n\nfunction rgb2hcg(r255: number, g255: number, b255: number): HCG {\n\tconst [hue, min255, max255] = rgb2hexhue(r255, g255, b255)\n\tconst c1 = (max255 - min255) / 255\n\tconst _g1 = c1 < 1 ? min255 / 255 / (1 - c1) : 0\n\treturn [hue, c1, _g1]\n}\n\n_input.hcg = hcg2rgb\n\nfunction cielab2rgb(LStar100: number, aStar: number, bStar: number, alpha = 1): RGBA {\n\tconst [x, y, z] = cielab2xyz(LStar100, aStar, bStar)\n\treturn xyz2rgb(x, y, z, alpha)\n}\n\nfunction cielab2xyz(LStar100: number, aStar: number, bStar: number) {\n\tfunction fInv(t: number) {\n\t\tif (t > LAB_delta) {\n\t\t\treturn t ** 3\n\t\t} else {\n\t\t\treturn LAB_3DeltaPow2 * (t - 4 / 29)\n\t\t}\n\t}\n\treturn [\n\t\tLAB_Xn * fInv((LStar100 + 16) / 116 + aStar / 500),\n\t\tLAB_Yn * fInv((LStar100 + 16) / 116),\n\t\tLAB_Zn * fInv((LStar100 + 16) / 116 - bStar / 200),\n\t]\n}\nfunction xyz2cielab(x: number, y: number, z: number): LAB {\n\t// https://en.wikipedia.org/w/index.php?title=CIELAB_color_space&oldid=849576085#Forward_transformation\n\tfunction f(t: number) {\n\t\tif (t > LAB_deltaPow3) {\n\t\t\treturn cbrt(t)\n\t\t} else {\n\t\t\treturn t / LAB_3DeltaPow2 + 4 / 29\n\t\t}\n\t}\n\treturn [116 * f(y / LAB_Yn) - 16, 500 * (f(x / LAB_Xn) - f(y / LAB_Yn)), 200 * (f(y / LAB_Yn) - f(z / LAB_Zn))]\n}\n\n// const LAB_CONSTANTS = {\nconst LAB_Kn = 18\nconst LAB_Xn = 0.95047\nconst LAB_Yn = 1\nconst LAB_Zn = 1.08883\nconst LAB_delta = 0.206896552 // delta = 6 / 29\nconst LAB_3DeltaPow2 = 0.12841855 // 3 * delta ** 2\nconst LAB_deltaPow3 = 0.008856452 // delta ** 3\n// }\n\nfunction rgb2lab(r255: number, g255: number, b255: number): RGB {\n\tconst [x, y, z] = rgb2xyz(r255, g255, b255)\n\treturn xyz2cielab(x, y, z)\n}\n\nfunction rgb2xyz(r255: number, g255: number, b255: number): XYZ {\n\t// https://en.wikipedia.org/wiki/SRGB#The_reverse_transformation\n\tconst r1Linear = rgbChannel2RgbLinear(r255)\n\tconst g1Linear = rgbChannel2RgbLinear(g255)\n\tconst b1Linear = rgbChannel2RgbLinear(b255)\n\tconst X = 0.4124564 * r1Linear + 0.3575761 * g1Linear + 0.1804375 * b1Linear\n\tconst Y = 0.2126729 * r1Linear + 0.7151522 * g1Linear + 0.072175 * b1Linear\n\tconst Z = 0.0193339 * r1Linear + 0.119192 * g1Linear + 0.9503041 * b1Linear\n\treturn [X, Y, Z]\n}\nfunction xyz2rgb(X1: number, Y1: number, Z1: number, alpha1 = 1): RGBA {\n\t// https://en.wikipedia.org/wiki/SRGB#The_forward_transformation_(CIE_XYZ_to_sRGB)\n\tconst r1Linear = 3.2404542 * X1 - 1.5371385 * Y1 - 0.4985314 * Z1\n\tconst g1Linear = -0.969266 * X1 + 1.8760108 * Y1 + 0.041556 * Z1\n\tconst b1Linear = 0.0556434 * X1 - 0.2040259 * Y1 + 1.0572252 * Z1\n\treturn [rgbLinearChannel2Rgb(r1Linear), rgbLinearChannel2Rgb(g1Linear), rgbLinearChannel2Rgb(b1Linear), alpha1]\n}\n\n_input.xyz = xyz2rgb\n_input.lab = cielab2rgb\n\n/**\n * For HSI, we use the direct angle calculation. I.e. atan2(beta, alpha). See wikipedia link. This is why we don't use\n * hcxm2rgb.\n */\nfunction hsi2rgb(hueDegrees: number, s1: number, i1: number, alpha1 = 1): RGBA {\n\t/*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n     */\n\tlet r, g, b\n\tlet hRad = hueDegrees * DEG2RAD\n\tif (hRad < (2 * PI) / 3) {\n\t\tb = (1 - s1) / 3\n\t\tr = (1 + (s1 * cos(hRad)) / cos(PI / 3 - hRad)) / 3\n\t\tg = 1 - (b + r)\n\t} else if (hRad < (4 * PI) / 3) {\n\t\thRad -= (2 * PI) / 3\n\t\tr = (1 - s1) / 3\n\t\tg = (1 + (s1 * cos(hRad)) / cos(PI / 3 - hRad)) / 3\n\t\tb = 1 - (r + g)\n\t} else {\n\t\thRad -= (4 * PI) / 3\n\t\tg = (1 - s1) / 3\n\t\tb = (1 + (s1 * cos(hRad)) / cos(PI / 3 - hRad)) / 3\n\t\tr = 1 - (g + b)\n\t}\n\treturn [3 * i1 * r * 255, 3 * i1 * g * 255, 3 * i1 * b * 255, alpha1]\n}\n\n/**\n * For HSI, we use the direct angle calculation. I.e. atan2(beta, alpha). See wikipedia link. This is why we don't use\n * rgb2hexhue.\n */\nfunction rgb2hsi(r255: number, g255: number, b255: number): HSI {\n\t// See https://en.wikipedia.org/wiki/HSL_and_HSV#Hue_and_chroma\n\t// See https://en.wikipedia.org/wiki/HSL_and_HSV#Lightness\n\tconst r1 = r255 / 255\n\tconst g1 = g255 / 255\n\tconst b1 = b255 / 255\n\tconst i1 = (r1 + g1 + b1) / 3\n\tif (r1 == g1 && g1 == b1) {\n\t\treturn [0, 0, i1]\n\t} else {\n\t\tconst alpha = (1 / 2) * (2 * r1 - g1 - b1)\n\t\tconst beta = (sqrt(3) / 2) * (g1 - b1)\n\t\tconst hRad = atan2(beta, alpha)\n\t\tconst min1 = min(r1, g1, b1)\n\t\tconst s1 = 1 - min1 / i1\n\t\treturn [(hRad < 0 ? 2 * PI + hRad : hRad) * RAD2DEG, s1, i1]\n\t}\n}\n\n_input.hsi = hsi2rgb\n\ninterpolators.hsv = interpolators.hsl = interpolators.hsi = interpolators.lch = interpolators.hcg = function interpolate_hsx(\n\tcolor1: chroma.Color,\n\tcolor2: chroma.Color,\n\tf: number,\n\tm: \"hsv\" | \"hsl\" | \"hsi\" | \"lch\" | \"hcg\",\n) {\n\tconst [a1, b1, c1] = color1[m]()\n\tconst [a2, b2, c2] = color2[m]()\n\tfunction lerpHue(hue1: number, hue2: number, f: number) {\n\t\tconst dh = norm360(hue2 - hue1 + 180) - 180\n\t\treturn hue1 + f * dh\n\t}\n\treturn chroma[m](\n\t\t(\"h\" == m.charAt(0) ? lerpHue : lerp)(a1, a2, f),\n\t\tlerp(b1, b2, f),\n\t\t(\"h\" == m.charAt(2) ? lerpHue : lerp)(c1, c2, f),\n\t)\n}\n\nfunction indexOfMax<T>(arr: ArrayLike<T>, f: (el: T) => number) {\n\tlet maxValue = -Infinity,\n\t\tmaxValueIndex = -1\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst value = f(arr[i])\n\t\tif (value > maxValue) {\n\t\t\tmaxValue = value\n\t\t\tmaxValueIndex = i\n\t\t}\n\t}\n\treturn maxValueIndex\n}\nfunction withMax<T>(arr: ArrayLike<T>, f: (el: T) => number): T {\n\treturn arr[indexOfMax(arr, f)]\n}\n"],"names":["abs","atan2","cos","floor","log","min","max","round","sign","sin","sqrt","cbrt","PI","hypot","Math","lerp","a","b","f","clamp","x","newtonIterate1d","xStart","max_steps","eps","fx","dfdx","console","TWOPI","DEG2RAD","RAD2DEG","chroma","args","Color","length","guess","slice","Array","isArray","[object Object]","r","g","this","col2","m","mix","doRound","clamp_","t","mode","r255","g255","b255","a1","rgbString","toString","padStart","alphaString","rgb2hex","hue","min1","max1","rgb2hexhue","l1","s1","rgb2hsl","min255","max255","rgb2hsv","c1","rgb2hcg","map","join","rgb2css","h","s","l","alpha","rnd","hsl2css","hsl","Error","closest","num","name","Object","keys","w3cx11","find","thisLStar","thisAStar","thisBStar","lab","arr","indexOfMax","lStar","aStar","bStar","k","rgb2cmyk","lum1","Y","rgb2xyz","undefined","inverseLerp","val","modeAndChannel","value","channel","split","src","i","indexOf","luminance","black","white","alpha1","rgb","amount","LAB_Kn","darker","c","lch","saturate","r1","g1","b1","i1","beta","hRad","rgb2hsi","rgb2lab","rgbNum","rgb2num","b2","lab2lch","rgb2lch","color","r2","g2","a2","prototype","css","kelvin","temperature","OrRd","PuBu","BuPu","Oranges","BuGn","YlOrBr","YlGn","Reds","RdPu","Greens","YlGnBu","Purples","GnBu","Greys","YlOrRd","PuRd","Blues","PuBuGn","Viridis","Spectral","RdYlGn","RdBu","PiYG","PRGn","RdYlBu","BrBG","RdGy","PuOr","Set2","Accent","Set1","Set3","Dark2","Paired","Pastel2","Pastel1","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflower","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","laserlemon","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrod","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","maroon2","maroon3","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","purple2","purple3","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellow","yellowgreen","start","rotations","gamma","lightness","at","getOwnPropertyNames","CubeHelix","forEach","key","_start","_rotations","_gamma","_hue","_lightness","scale","fract","amp","cos_a","sin_a","col1","c2","res","interpolators","num2rgb","blend_fs","scales","_at","Scale","brewer","_init","randomSource","random","cssString","css2rgb","kelvin2rgb","chromables","colors","_average_lrgb","numSum","alphaSum","col","xyz","dx","dy","xyz2","charAt","A","_bezier","bottom","top","blend_f","each","_","_screen","_overlay","_dodge","_burn","classes","_classes","domain","limits","_colors","_pos","p","_min","_max","d","lerpInv","_mode","_resetCache","outputFormat","_out","enableCorrectLightness","_correctLightness","sign2","paddingLeft","paddingRight","_paddingLeft","_paddingRight","numColors","format","result","_color","from","samples","enableCache","_cache","Map","colorsOrFunction","findIndex","cls","bypassMap","_getClass","_tCorrectedLightness","tHash","cacheResult","get","set","t0_1","L_ideal","steps","fA","fC","bisect","clear","analyze","data","Infinity","sum","values","count","isNaN","push","add","info","sort","startsWith","min_log","LOG10E","max_log","pb","n","assignments","clusterSizes","repeat","nb_iters","centroids","fill","minDistIndex","newCentroids","j","some","nc","kClusters","tmpKMeansBreaks","kCluster","v","l2","channelDifferences","channelValue","channelIndex","reference","sample","L","C","L1","L2","sl","sc","h1","norm360","c4","sh","delC","delA","delB","v1","v2","_input","lab0","lab1","lab2","lab3","bezier2","p0","p1","p2","bezier3","p3","I0","I1","JSON","stringify","channels","rSquareSum","gSquareSum","bSquareSum","rgba","hex2rgb","hex","match","parseInt","degrees","xyz1","n1","n2","lrgb","hsl2rgb","hsv","hueDegrees","hcxm2rgb","WS","FLOAT","CSS_RGB_REGEX","RegExp","CSS_RGB_WS_REGEX","CSS_RGB_PERCENT_REGEX","CSS_RGB_WS_PERCENT_REGEX","CSS_HSL_REGEX","CSS_HSL_WS_REGEX","toLowerCase","CONVERSION","deg","rad","turn","angleUnit","rgbChannel2RgbLinear","x255","x1","rgbLinearChannel2Rgb","xLinear1","e","M","delta","hueTurnX6","m1","m255","cm255","xm255","cielab2rgb","LStar100","y","z","fInv","LAB_delta","LAB_3DeltaPow2","LAB_Xn","LAB_Yn","LAB_Zn","cielab2xyz","xyz2rgb","hDegrees","lch2lab","cmyk","y1","k1","gl","K","hcg","LAB_deltaPow3","xyz2cielab","r1Linear","g1Linear","b1Linear","X1","Y1","Z1","maxValue","maxValueIndex","hsi","color1","color2","lerpHue","hue1","hue2"],"mappings":"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"}